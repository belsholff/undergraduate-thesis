#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass ../../../../Documentos/UFES/PG/undergraduate-thesis/thesis/lyx/abntex2
\begin_preamble
% ---
% PACOTES
% ---
\usepackage{lastpage}			% Usado pela Ficha catalográfica
\usepackage{indentfirst}			% Indenta o primeiro parágrafo de cada seção.
\usepackage{color}			% Controle das cores
\RequirePackage{url}			% deve ser carregado para tratar url de forma correta e usado pelo abntex2cite
\RequirePackage{breakurl}			% trata de forma correta a quebra de url entre linhas
% ---
% Pacotes de citações
% ---
\usepackage[brazilian,hyperpageref]{backref}	 % Paginas com as citações na bibl
\usepackage[num,abnt-url-package=url]{abntex2cite}	% Citações padrão ABNT
% O carregamento da opção abnt-url-package=url corrige os hiperlinks com quebra de linha na bibliografia
% --- 
% CONFIGURAÇÕES DE PACOTES
% --- 

% ---
% Configurações do pacote backref
% Usado sem a opção hyperpageref de backref
\renewcommand{\backrefpagesname}{Citado na(s) página(s):~}
% Texto padrão antes do número das páginas
\renewcommand{\backref}{}
% Define os textos da citação
\renewcommand*{\backrefalt}[4]{
\ifcase #1
Nenhuma citação no texto.
\or
Citado na página #2.
\else
Citado #1 vezes nas páginas #2.
\fi}

% --- 
% Espaçamentos entre linhas e parágrafos 
% --- 

% O tamanho do parágrafo é dado por:
\setlength{\parindent}{1.3cm}

% Controle do espaçamento entre um parágrafo e outro:
\setlength{\parskip}{0.2cm}  % tente também \onelineskip

% ---
% Configurações de aparência do PDF final

% alterando o aspecto da cor azul
\definecolor{blue}{RGB}{41,5,195}

% informações do PDF
\hypersetup{
    unicode=true,
    backref=true,
    pagebackref=true,
    bookmarks=true,         		% show bookmarks bar?
%	    pdftitle={\titulocompleto}, 
%	    pdfauthor={\nomecompletoautor},
%	    pdfsubject={\imprimirpreambulo},
%	    pdfkeywords={\palavrachaveum}{\palavrachavedois}{\palavrachavetres},
    pdfproducer={LaTeX with abnTeX2}, 	% producer of the document
%	    pdfcreator={\nomecompletoautor},
    colorlinks=true,       		% false: boxed links; true: colored links
    linkcolor=blue,          	        % color of internal links
    citecolor=blue,        		% color of links to bibliography
    filecolor=magenta,      		% color of file links
    urlcolor=blue,			% color of url links
    bookmarksdepth=4,
    breaklinks=true			% deve ser usado com o pacote breakurl, sem ele não fuciona
}


\renewcommand{\partref}{\Partref}
\renewcommand{\tabref}{\Tabref}
\renewcommand{\figref}{\Figref}
\renewcommand{\chapref}{\Chapref}
\renewcommand{\secref}{\Secref}

% ---
% compila o indice
% ---
\makeindex
% ---
\end_preamble
\options 12pt,openright,twoside,a4paper,brazil,brazilian
\use_default_options false
\maintain_unincluded_children false
\language brazilian
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style unsrt
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Titulo
Implementação de Funções Virtuais de Rede usando ClickOS
\end_layout

\begin_layout Local
Vitória, Espírito Santo, Brasil
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
instituicao{Universidade Federal do Espírito Santo - UFES
\backslash
par
\end_layout

\begin_layout Plain Layout

Centro Tecnológico - CT
\backslash
par Graduação em Ciência da Computação}
\end_layout

\end_inset


\end_layout

\begin_layout Data
Julho 2018
\end_layout

\begin_layout Preambulo
Trabalho de conclusão de curso apresentado ao Departamento de Informática
 do Centro Tecnológico da Universidade Federal do Espírito Santo, como requisito
 parcial para obter o título de Bacharel em Ciência da Computação
\end_layout

\begin_layout Autor
Felipe Belsholff Pina
\end_layout

\begin_layout Orientador
Prof.
 Dr.
 Rodolfo da Silva Villaça
\end_layout

\begin_layout Co-Orientador
Prof.
 Dr.
 Magnos Martinello
\end_layout

\begin_layout Tipo-trabalho
Trabalho de Conclusão de Curso
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%
\backslash
let
\backslash
ref
\backslash
autoref
\end_layout

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Veja 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://tex.stackexchange.com/questions/6059/table-figure-and-listing-prefixes
\end_layout

\end_inset

 para uma explicação.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
frenchspacing
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pretextual
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
imprimircapa
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
imprimirfolhaderosto*{}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Ficha catalográfica entra aqui, se necessária.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Errata seguirá aqui, se necessária.
\end_layout

\end_inset


\end_layout

\begin_layout Folha de Aprovacao
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
begin{center}     
\end_layout

\begin_layout Plain Layout

			{
\backslash
ABNTEXchapterfont
\backslash
large
\backslash
imprimirautor}
\end_layout

\begin_layout Plain Layout

		
\end_layout

\begin_layout Plain Layout

		
\backslash
vspace*{
\backslash
fill}
\backslash
vspace*{
\backslash
fill}
\end_layout

\begin_layout Plain Layout

		
\backslash
begin{center}       
\end_layout

\begin_layout Plain Layout

			
\backslash
ABNTEXchapterfont
\backslash
bfseries
\backslash
Large
\backslash
imprimirtitulo     
\end_layout

\begin_layout Plain Layout

		
\backslash
end{center}     
\end_layout

\begin_layout Plain Layout

		
\backslash
vspace*{
\backslash
fill}          
\end_layout

\begin_layout Plain Layout

		
\end_layout

\begin_layout Plain Layout

		
\backslash
hspace{.45
\backslash
textwidth}     
\end_layout

\begin_layout Plain Layout

		
\backslash
begin{minipage}{.5
\backslash
textwidth}         
\end_layout

\begin_layout Plain Layout

			
\backslash
imprimirpreambulo     
\end_layout

\begin_layout Plain Layout

		
\backslash
end{minipage}%     
\end_layout

\begin_layout Plain Layout

		
\backslash
vspace*{
\backslash
fill}    
\end_layout

\begin_layout Plain Layout

	
\backslash
end{center}             
\end_layout

\begin_layout Plain Layout

	Trabalho aprovado.
 
\backslash
imprimirlocal, 13 de julho de 2018:
\end_layout

\begin_layout Plain Layout

	
\end_layout

\begin_layout Plain Layout

	
\backslash
assinatura{
\backslash
textbf{
\backslash
imprimirorientador} 
\backslash

\backslash
 Orientador}	
\end_layout

\begin_layout Plain Layout

	
\backslash
assinatura{
\backslash
textbf{
\backslash
imprimircoorientador} 
\backslash

\backslash
 Co-orientador}     	
\end_layout

\begin_layout Plain Layout

	
\backslash
assinatura{
\backslash
textbf{Prof.
 Dr.
 Vinicius Fernandes Soares Mota} 
\backslash

\backslash
 Convidado Interno}
\end_layout

\begin_layout Plain Layout

	
\backslash
assinatura{
\backslash
textbf{Profa.
 M.Sc.
 Cristina Klippel Dominicini} 
\backslash

\backslash
 Convidada Externa}
\end_layout

\begin_layout Plain Layout

	
\end_layout

\begin_layout Plain Layout

	
\backslash
begin{center}     
\end_layout

\begin_layout Plain Layout

		
\backslash
vspace*{0.5cm}     
\end_layout

\begin_layout Plain Layout

		{
\backslash
large
\backslash
imprimirlocal}     
\end_layout

\begin_layout Plain Layout

		
\backslash
par 
\end_layout

\begin_layout Plain Layout

		{
\backslash
large
\backslash
imprimirdata}     
\end_layout

\begin_layout Plain Layout

		
\backslash
vspace*{1cm}   
\end_layout

\begin_layout Plain Layout

	
\backslash
end{center}    
\end_layout

\end_inset


\end_layout

\begin_layout Dedicatoria
\align center
\begin_inset VSpace vfill*
\end_inset


\end_layout

\begin_layout Dedicatoria
\align center

\shape italic
Em memória de Leonina.
 Dedicado àqueles que diante das
\begin_inset Newline newline
\end_inset

 negativas do mundo, contrariaram-no na busca pelo sim.
\end_layout

\begin_layout Dedicatoria
\begin_inset VSpace vfill*
\end_inset


\end_layout

\begin_layout Agradecimentos
A
\end_layout

\begin_layout Epigrafe
\align right
\begin_inset VSpace vfill*
\end_inset


\end_layout

\begin_layout Epigrafe
\paragraph_spacing single
\align right

\shape italic
\begin_inset Quotes eld
\end_inset

Você toma a pílula azul — a história acaba, e
\begin_inset Newline newline
\end_inset

você acorda em sua cama acreditando no que
\begin_inset Newline newline
\end_inset

quiser acreditar.
 Você toma a pílula vermelha —
\begin_inset Newline newline
\end_inset

 fica no País da Maravilhas, e lhe mostro quão
\begin_inset Newline newline
\end_inset

fundo a toca do coelho vai.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Epigrafe
\align right
(Morpheus, The Matrix)
\end_layout

\begin_layout Resumo
Com o advento da virtualização e o surgimento do modelo de computação em
 nuvem (
\shape italic
Cloud Computing
\shape default
), uma das consequências imediatas para as empresas e instituições foi a
 redução da aquisição de novos equipamentos.
 Além disso, ainda no ponto de vista de infraestrutura, desacoplar funções
 que estavam embarcadas em hardware específico e fechado, trazendo-as até
 camadas de abstração superiores, habilita um menor tempo de implantação
 e de manutenção, acrescido de um grande salto com relação a escalabilidade
 e gerenciamento das mesmas.
\end_layout

\begin_layout Resumo
Neste cenário, o objetivo do paradigma NFV é prover funções de rede como:
 
\shape italic
firewalls
\shape default
, balanceadores de carga, NATs, e IDSs, etc, através de uma linguagem de
 marcação, colaborando com a flexibilidade do provisionamento e a programabilida
de de tais funções, até então também engessadas pelo uso dos 
\shape italic
middleboxes
\shape default
 de prateleira.
\end_layout

\begin_layout Resumo
Neste quesito, ClickOS propõe uma plataforma de virtualização para criação
 de funções virtuais de rede de alto desempenho, a serem amplamente utilizados
 por desenvolvedores de VNFs.
 Ele provê como ferramenta uma máquina virtual minimalista, escalável e
 otimizada para executar o 
\shape italic
software
\shape default
 Click no 
\shape italic
hypervisor
\shape default
 do Projeto Xen, seguido de uma sequência de otimizações focadas na vazão
 de pacotes.
\end_layout

\begin_layout Resumo
No entanto, a pouca quantidade de trabalhos ou artigos detalhando o uso
 de ClickOS diante da atual demanda por NFV, até mesmo em língua inglesa,
 dificulta sua adoção, difusão, e por fim, o desenvolvimento da plataforma
 e seus conceitos por pesquisadores, professores, empresas e outros atores
 interessados, mesmo que este seja em software livre e possua uma documentação
 online, já que o conhecimento sobre ele está disperso.
\end_layout

\begin_layout Resumo
Assim sendo, este trabalho tem como objetivo apresentar detalhadamente ClickOS
 como uma alternativa para a implementação de funções virtuais de rede dentro
 de NFV, usando como cenário o balanceamento de carga em serviços de hospedagem
 
\shape italic
web
\shape default
.
\end_layout

\begin_layout Resumo
\noindent

\series bold
Palavras-chave: 
\series default
NFV; virtualização de funções de rede; VNF; função virtual de rede; middleboxes
 virtuais; Click; ClickOS.
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Resumo
With the advent of virtualization and the Cloud Computing model arising,
 one of the fresh consequences for companies and institutions was new equipment
 acquisition reduction.
 In addition, still from an infrastructure viewpoint, decoupling functions
 that were embedded into specific and closed hardware up to higher abstraction
 layers enables a shorter deployment and maintenance time, plus a big increase
 related to scability and management of them.
\end_layout

\begin_layout Resumo
In this scenario, the NFV paradigm goals is provide network functions as:
 firewalls, load balancers, NATs, IDSes, etc, through a markup language,
 collaborating with the provisioning flexibility and programmability of
 such functions, until then also plastered by the use if shelf middleboxes.
\end_layout

\begin_layout Resumo
In this regard, ClickOS proposes a virtualization platform for high performance
 virtual network functions construction by developers.
 It provides as a tool a minimalist, scalable, and optimized virtual machine
 to run Click software in the Xen Project hypervisor, followed by some optimizat
ions focused on packet throughput.
\end_layout

\begin_layout Resumo
However, a lack of works, articles or papers detailing ClickOS use in face
 of current NFV demand, even in english language, makes it difficult to
 adopt, disseminate, and finally, the development of the platform and its
 concepts by reseachers, professors, companies and other stakeholders, even
 if it is in free software and has an online documentation, since the knowledge
 about it is dispersed.
\end_layout

\begin_layout Resumo
Thus, this work aims to present in detail ClickOS as an alternative to the
 virtual network functions implementation within NFV, using a load balancing
 scenario in web hosting services.
\end_layout

\begin_layout Resumo
\noindent

\series bold
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Abstract
\end_layout

\end_inset

Keywords:
\series default
 NFV; network functions virtualization; VNF; virtual network function; virtual
 middleboxes; Click; ClickOS.
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FloatList figure

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FloatList table

\end_inset


\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

API
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Interface de Programação de Aplicação
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

ARP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Protocolo de Resolução de Endereços
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

BSS
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Sistemas de Suporte aos Negócios
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

BWM-NG
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Monitor de Largura de Banda NG
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

CAPEX
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Capital Investido
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

CPU
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Unidade de Processamento Central
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

CSS
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Folhas de Estilo em Cascata
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

CSV
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Valores Separados por Vírgula
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

DHCP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Protocolo de Configuração Dinâmica de Dispositivos
 
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

DNAT
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Tradução de Endereços de Rede de Destino.
 Não confundir neste trabalho com Tradução de Endereços de Rede Dinâmicos.
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

DPDK
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Kit de Desenvolvimento em Plano de Dados da
 Intel
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

ETSI
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para o Instituto de Padronização de Telecomunicações
 Europeu
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

GNU
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo recursivo em língua inglesa para GNU não é Unix
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

HTML
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Linguagem de Marcação de Hipertexto
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

HTTP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Protocolo de Transmissão de Hipertexto
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

IDS
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Sistema de Detecção de Intrusão
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

IETF
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Força-Tarefa de Engenharia da Internet
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

IRTF
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Força-Tarefa de Pesquisa da Internet
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

IP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Protocolo da Internet
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

KVM
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Máquina Virtual baseada em Núcleo
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

LAMP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para a junção dos nomes de Linux, Apache, MySQL
 e PHP
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

MAC
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Controle de Acesso ao Meio
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

MIT
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Instituto Tecnológico de Massachussetts,
 Estados Unidos
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

MSS
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Tamanho de Segmento Máximo
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

NAT
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Tradução de Endereços de Rede
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

NEC
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Companhia Elérica Nipônica
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

NFV
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Virtualização de Funções de Rede
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

NFV MANO
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Combinação de sigla e acrônimo em língua inglesa para Orquestração e Gerenciame
nto da Virtualização de Funções de Rede
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

NFVI
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Infraestrutura de Virtualização de Funções
 de Rede
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

NIC.BR
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua portuguesa para Núcleo de Informação e Coordenação do Ponto
 BR
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

OPEX
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Despesa Operacional
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

OSI
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Interconexão de Sistemas Abertos
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

PHP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Personal Home Page
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

OSS
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Sistemas de Suporte às Operações
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

RED
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Detecção Adiantada Randômica
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

RFC
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Requisição Para Comentários
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

SDN
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Rede Definida por Software
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

SNMP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Protocolo Simples de Gerência de Rede
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

SQL
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Linguagem de Consulta Estruturada
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

SSH
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para o protocolo Shell Seguro
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

STP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Protocolo de Árvore Geradora
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

TCP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa Protocolo de Controle de Transmissão
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

UDP
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa Protocolo de Datagramas de Usuário
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

VIM
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Acrônimo em língua inglesa para Gerente de Infraestrutura Virtual
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

VM
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Máquina Virtual
\end_layout

\begin_layout Siglas
\begin_inset ERT
status open

\begin_layout Plain Layout

[
\end_layout

\end_inset

VNF
\begin_inset ERT
status open

\begin_layout Plain Layout

]
\end_layout

\end_inset

 Sigla em língua inglesa para Função Virtual de Rede 
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
tableofcontents*
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textual
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
INTRODUÇÃO
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Verificar se o texto está de acordo com os ítens abaixo.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Os 
\shape italic
middleboxes
\shape default
 são dispositivos de propósito específico que implantam serviços ao longo
 de redes físicas, promovendo segurança, isolamento, compartilhamento, otimizaçã
o, gerenciamento, etc.
 São exemplos os 
\shape italic
switches
\shape default
, roteadores, 
\shape italic
firewalls
\shape default
, balanceadores de carga, priorizadores de pacotes, limitadores de banda,
 
\shape italic
proxies
\shape default
, filtros de conteúdo, dentre outros 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

.
 Durante muito tempo foram exclusivamente dispositivos de 
\shape italic
hardware
\shape default
 com 
\shape italic
software
\shape default
 embarcado, com alto custo e ciclo de vida reduzido, diante do rápido desenvolvi
mento das redes de computadores.
 No âmbito de atualizações e manutenções, não são equipamentos modulares,
 o que somado ao fim do suporte, ocasiona a troca dos aparelhos, prejudicando
 o capital investido (CAPEX) e a despesa operacional (OPEX) das empresas
 usuárias.
\end_layout

\begin_layout Standard
No entanto, este modelo não está mais sozinho.
 Esforços para a construção de 
\shape italic
middleboxes
\shape default
 em 
\shape italic
hardware
\shape default
 de propósito geral já eram discutidos desde o fim da década de noventa,
 com Click 
\begin_inset CommandInset citation
LatexCommand cite
key "morris_click_1999"

\end_inset

, por exemplo.
 O início deste século trouxe o processamento em alta frequência, junto
 com a capacidade de paralelizá-lo, e mais a frente, a viabilidade da camada
 de virtualização de maneira geral, com menor perda de desempenho, grande
 eficiência energética e econômica.
 Desta forma, os 
\shape italic
middleboxes
\shape default
 dissociados de 
\shape italic
hardware
\shape default
 se tornaram viáveis, na forma de funções virtuais de rede (VNFs) com o
 uso de tecnologias como 
\shape italic
containers
\shape default
 e paravirtualização.
\end_layout

\begin_layout Standard
Um dos padrões em desenvolvimento nesse sentido é o de Virtualização de
 Funções de Rede (NFV), que sob responsabilidade do Gerente de Infraestrutura
 Virtual (VIM) aloca recursos de um hardware de propósito geral para prover
 funções personalizadas, habilitando escalabilidade, manutenibilidade, maior
 ciclo de vida de hardware e software, e economia de recursos e investimentos
 – justamente os pontos fracos do modelo acoplado ao hardware.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
projeção de nfv e cloud 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Algumas das tecnologias existentes para provimento de funções virtuais nesse
 âmbito são P4 
\begin_inset CommandInset citation
LatexCommand cite
key "Bosshart:2014:PPP:2656877.2656890"

\end_inset

, NetBricks
\begin_inset CommandInset citation
LatexCommand cite
key "panda_netbricks:_2016"

\end_inset

, Elastic Edge
\begin_inset CommandInset citation
LatexCommand cite
key "palkar_e2:_2015"

\end_inset

, OpenNetVM 
\begin_inset CommandInset citation
LatexCommand cite
key "zhang_opennetvm:_2016"

\end_inset

.
 Citado anteriormente como exemplo, Click foi um dos casos de sucesso em
 matéria de desacoplar código, sendo o equivalente de sua época a uma função
 virtual de rede.
 E mais de uma década depois, sua existência e suas vantagens se tornaram
 parte de um desses projetos de virtualização de dispositivos de rede mais
 populares e que é utilizado neste trabalho: chama-se ClickOS 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

.
\end_layout

\begin_layout Standard
ClickOS otimiza a trinca Click, Projeto Xen 
\begin_inset CommandInset citation
LatexCommand cite
key "barham_xen_2003"

\end_inset

 e MiniOS 
\begin_inset CommandInset citation
LatexCommand cite
key "Popuri_200-"

\end_inset

 em uma plataforma integrável a soluções NFV como mostra 
\begin_inset CommandInset citation
LatexCommand cite
key "ventre_performance_2016"

\end_inset

, para: 
\end_layout

\begin_layout Alineas
uma fácil implementação de VNFs com uma linguagem de marcação voltada para
 visão de fluxos, sendo de fácil legibilidade;
\end_layout

\begin_layout Alineas
o provimento da camada de virtualização, incluindo a gerência dos recursos
 das máquinas virtuais;
\end_layout

\begin_layout Alineas
prover um 
\shape italic
micro-kernel
\shape default
 suficientemente robusto e pequeno para que as VNFs sejam executadas de
 maneira escalável com o devido isolamento em um ambiente de paravirtualização.
\end_layout

\begin_layout Standard
No entanto, até pela questão das disputas do nicho e pelo ainda recente
 desenvolvimento de soluções para provimento de VNFs, a plataforma sofre
 com a falta de materiais didáticos, sejam em inglês ou português, mesmo
 aqueles que tratam apenas de Click, desestimulando seu uso em detrimento
 de outros semelhantes como P4.
 Como exemplo dessa questão, é possível citar a falta de documentações sobre:
 a integração de Click com os 
\shape italic
switches
\shape default
 VALE 
\begin_inset CommandInset citation
LatexCommand cite
key "rizzo_vale_2012"

\end_inset

 e OpenVSwitch 
\begin_inset CommandInset citation
LatexCommand cite
key "pfaff_extending_2009"

\end_inset

 através de ClickOS; as documentações de sua instalação; a falta de exemplos
 sobre o correto uso dos elementos; exemplos implementados e comentados;
 e documentação oficial incompleta.
\end_layout

\begin_layout Section
OBJETIVO
\end_layout

\begin_layout Standard
Este trabalho apresenta a plataforma para implementação de VNFs ClickOS,
 destacando sua importância e atuação dentro de NFV, entregando um rápido
 desenvolvimento e manutenção de funções, e consolidando a virtualização
 de dispositivos de redes como alternativa viável aos dispositivos físicos
 semelhantes.
\end_layout

\begin_layout Standard
Como objetivo específico, no trabalho implementa-se duas funções virtuais
 de rede em ClickOS detalhadamente, com um cenário comum ao balanceamento
 de carga em serviços de hospedagem 
\shape italic
web
\shape default
, e avalia a prova de conceito da plataforma a partir de testes.
\end_layout

\begin_layout Section
ESTRUTURA DO TRABALHO
\end_layout

\begin_layout Standard
Para além deste, o 
\begin_inset CommandInset ref
LatexCommand formatted
reference "chap:CONCEITOS"

\end_inset

 trata dos conceitos principais associados ao trabalho; o 
\begin_inset CommandInset ref
LatexCommand formatted
reference "chap:ENTENDENDO-CLICKOS"

\end_inset

 visa detalhar os mecanismos de Click e ClickOS para suas aplicações no
 trabalho; o 
\begin_inset CommandInset ref
LatexCommand formatted
reference "chap:PROJETO-E-IMPLEMENTAÇÃO"

\end_inset

 projeta e executa a realização do objetivo específico, discorrendo sobre
 as funções de rede e o comportamento esperado, exemplificando passo a passo
 os rastros de uma comunicação dentro do cenário, destacando vantagens adquirida
s com o uso das ferramentas e plataformas; o 
\begin_inset CommandInset ref
LatexCommand formatted
reference "chap:TESTES"

\end_inset

 versa sobre a realização e os resultados dos testes no cenário proposto,
 buscando confirmar a posição de ClickOS como alternativa aos dispositivos
 físicos de rede; o 
\begin_inset CommandInset ref
LatexCommand formatted
reference "chap:CONCLUSÃO"

\end_inset

 caminha no sentido de analisar o esforço realizado, enfatizar pontos positivos
 e negativos da plataforma e da proposta, e encaminhar possíveis trabalhos
 futuros.
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Chapter
CONCEITOS
\begin_inset CommandInset label
LatexCommand label
name "chap:CONCEITOS"

\end_inset


\end_layout

\begin_layout Standard
Este capítulo expõe rapidamente dois conceitos necessários para entender
 o ecossistema onde o trabalho proposto se insere.
 Na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Virtualização-de-Funções"

\end_inset

, uma rápida introdução ao contexto de NFV é exposta, com suas motivações
 e realizações que possibilitam a discussão da virtualização dos caros dispositi
vos de rede.
\end_layout

\begin_layout Standard
Já na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Linux-Bridge"

\end_inset

, o 
\shape italic
switch
\shape default
 virtual Ethernet Linux Bridge 
\begin_inset CommandInset citation
LatexCommand cite
key "varis2012anatomy"

\end_inset

 é posicionado dentro do cenário de virtualização, com o cuidado de explicar
 ao máximo seu mecanismo básico de uso, como insumo para o restante do trabalho.
\end_layout

\begin_layout Section
Virtualização de Funções de Rede – NFV
\begin_inset CommandInset label
LatexCommand label
name "sec:Virtualização-de-Funções"

\end_inset


\end_layout

\begin_layout Standard
O modelo NFV foi proposto em 2012 pelas empresas de telecomunicações em
 conjunto com o Instituto de Padronização de Telecomunicações Europeu (ETSI),
 tendo a redução de CAPEX e de OPEX como principal objetivo.
 Para tal, a proposta é desacoplar as funções em software dos equipamentos
 de rede hospedeiros 
\begin_inset CommandInset citation
LatexCommand cite
key "mijumbi_network_2016"

\end_inset

.
 
\end_layout

\begin_layout Standard
Para o ETSI, paradigma já possui uma arquitetura especificada, embora ainda
 não fechada ou padronizada.
 Os itens mais importantes são descritos da seguinte forma:
\end_layout

\begin_layout Alineas
Infraestrutura NFV (NFVI): combinação de recursos de 
\shape italic
hardware
\shape default
 e 
\shape italic
software
\shape default
 sobre os quais as funções virtuais de rede são desenvolvidas.
 As abstrações dos recursos são atingidas ao inserir sobre elas uma camada
 de virtualização usando 
\shape italic
hypervisors
\shape default
, habilitando então a separação entre as funções de rede e os recursos físicos.
 Máquinas Virtuais (VMs) representam o uso de recursos de processamento
 e armazenamento, enquanto elos e nós virtuais (sistemas operacionais em
 VMs) representam o uso de recursos de rede 
\begin_inset CommandInset citation
LatexCommand cite
key "mijumbi_network_2016"

\end_inset

.
 São exemplos de 
\shape italic
hypervisors
\shape default
 o Projeto Xen, KVM 
\begin_inset CommandInset citation
LatexCommand cite
key "kvm_article"

\end_inset

, HyperV 
\begin_inset CommandInset citation
LatexCommand cite
key "scooley_introducao_hyperV"

\end_inset

, VMware vSphere 
\begin_inset CommandInset citation
LatexCommand cite
key "vsphere"

\end_inset

, VirtualBox 
\begin_inset CommandInset citation
LatexCommand cite
key "watson_virtualbox:_2008"

\end_inset

.
\end_layout

\begin_layout Alineas
Serviços e Funções Virtuais de Rede: funções de rede são normalmente dispositivo
s dentro de uma infraestrutura de rede com interfaces externas e comportamento
 bem definidas 
\begin_inset CommandInset citation
LatexCommand cite
key "etsi2014gs"

\end_inset

.
 Alguns exemplos mais comuns são: firewall, roteadores, balanceadores de
 carga.
 Boa parte delas também é conhecida pelo termo 
\shape italic
middlebox
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "rfc3234"

\end_inset

.
 Já as VNFs são representações implementadas e implantadas em recursos virtuais,
 que podem conter diversos elementos internos de rede, e ser instalada em
 diversas soluções virtualizadas como VMs e containers Docker 
\begin_inset CommandInset citation
LatexCommand cite
key "Merkel:2014:DLL:2600239.2600241"

\end_inset

 ou Linux 
\begin_inset CommandInset citation
LatexCommand cite
key "biederman2006multiple"

\end_inset

, seja de forma a replicar funcionalidades ou de forma a dividir tarefas
 de uma dada função 
\begin_inset CommandInset citation
LatexCommand cite
key "mijumbi_network_2016"

\end_inset

.
 Do ponto de vista do usuário, as VNFs devem ser idênticas as funções de
 rede, inclusive em termos de desempenho 
\begin_inset CommandInset citation
LatexCommand cite
key "mijumbi_network_2016"

\end_inset

.
\end_layout

\begin_layout Alineas
Orquestração e Gerenciamento NFV (NFV MANO): funcionalidades para prover
 as VNFs e suas operações relacionadas, tais como as configurações de recursos,
 de ciclo de vida, e o comportamento das funções virtuais, sob responsabilidade
 do VIM.
 Isso inclui a orquestração e o gerenciamento do ciclo de vida de recursos
 de 
\shape italic
software
\shape default
 e 
\shape italic
hardware
\shape default
 que dão suporte a virtualização.
 NFV MANO foca em tarefas especificas para gerenciamento de virtualização
 no 
\shape italic
framework
\shape default
 NFV.
 O 
\shape italic
framework
\shape default
 em si é responsável por definir as interfaces para comunicação de componentes
 do NFV MANO, tal qual a coordenação de sistemas tradicionais de gerenciamento
 como os Sistemas de Suporte às Operações (OSS) e os Sistemas de Suporte
 aos Negócios (BSS) 
\begin_inset CommandInset citation
LatexCommand cite
key "mijumbi_network_2016"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Representação do modelo NFV
\begin_inset CommandInset label
LatexCommand label
name "fig:Representação-do-modelo-NFV"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/modelo_NFV.png
	lyxscale 75
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Adaptado de 
\begin_inset CommandInset citation
LatexCommand cite
key "han_network_2015"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Com a arquitetura descrita, várias implementações tiveram seu desenvolvimento
 inciado, como OPNFV 
\begin_inset CommandInset citation
LatexCommand cite
key "price2012opnfv"

\end_inset

 e OpenStack 
\begin_inset CommandInset citation
LatexCommand cite
key "sefraoui_openstack:_2012"

\end_inset

 e órgãos de padronização já discutem formas de universalizá-lo mesmo que
 questões técnicas e de negócios estejam abertas, como em NFVRG 
\begin_inset CommandInset citation
LatexCommand cite
key "_irtf_nfvrg_2015"

\end_inset

 da Força-Tarefa de Pesquisa da Internet (IRTF), associada a Força-Tarefa
 de Engenharia da Internet (IETF).
 Segundo 
\begin_inset CommandInset citation
LatexCommand cite
key "mijumbi_network_2016"

\end_inset

, algumas dessas questões são: a) como realizar o controle e a gerência
 de equipamentos legados; b) quais funções virtuais de rede devem ser implantada
s em 
\shape italic
datacenters
\shape default
 ou operadoras; c) quais devem estar dentro de VMs ou 
\shape italic
containers
\shape default
; d) quais recursos do NFVI são necessários para desenvolver uma determinada
 função virtual; e) quais os requerimentos operacionais de ambientes que
 operam VNFs e equipamentos legados.
\end_layout

\begin_layout Standard
O modelo proposto traz diversas vantagens em relação ao modelo de software
 acoplado a hardware além das economias financeiras por si só.
 A programabilidade das funções de rede permitem um desenvolvimento, manutenção
 e implantação de acordo com os anseios do cliente, de maneira mais rápida
 e estimulando um novo mercado de serviços de software para um novo extrato
 de empresas.
 Já o advento da virtualização traz a tona o uso de recursos de 
\shape italic
hardware
\shape default
 sob demanda, agrupando o que antes eram diversos equipamentos com recursos
 mal utilizados em um conjunto de 
\shape italic
hardwares
\shape default
 potentes, capaz de escalar recursos conforme o uso da rede se torne mais
 intenso, com custo mínimo para o desempenho, e menor para o investidor.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Linux-Bridge"

\end_inset

Linux Bridge
\end_layout

\begin_layout Standard
Os dispositivos de rede chamados comutadores (
\shape italic
switches
\shape default
) são responsáveis por conectar diversos nós entre si para assim facilitar
 uma rede local 
\begin_inset CommandInset citation
LatexCommand cite
key "varis2012anatomy"

\end_inset

.
 O objetivo da versão virtualizada desses equipamentos é basicamente igual,
 embora guarde diferenças de implementação como visto em 
\begin_inset CommandInset citation
LatexCommand cite
key "pfaff_extending_2009"

\end_inset

.
 Os 
\shape italic
switches
\shape default
 virtuais provêem conectividade entre VMs e destas com o mundo externo,
 envolvendo muitas das mesmas funções providas pelas versões físicas 
\begin_inset CommandInset citation
LatexCommand cite
key "pfaff_extending_2009"

\end_inset

 para centenas de dispositivos virtualizados por hospedeiro.
\end_layout

\begin_layout Standard
Um dos expoentes dessa classe é o OpenVSwitch, que leva programabilidade
 para as redes ao abordar a questão de Redes Definidas por Software (SDNs).
 No entanto outros mais simples podem ser úteis em determinadas situações.
 É o caso do VALE 
\begin_inset CommandInset citation
LatexCommand cite
key "rizzo_vale_2012"

\end_inset

 e do Ethernet Linux Bridge.
 O Linux Bridge faz parte do 
\shape italic
kernel
\shape default
 Linux 
\begin_inset CommandInset citation
LatexCommand cite
key "noauthor_linux_2018"

\end_inset

 como um módulo e está a pronta entrega para ambientes de virtualização
 de uso cotidiano ou voltados para testes, necessitando apenas de habilitá-lo
 no sistema, e possuindo suporte constante e consolidado.
 Ele é dividido de forma grosseira em quatro componentes como a maioria
 desses dispositivos 
\begin_inset CommandInset citation
LatexCommand cite
key "varis2012anatomy"

\end_inset

: 
\end_layout

\begin_layout Alineas
O conjunto de portas, usado para encaminhar tráfego entre os dispositivos
 ligados a ele, reais ou virtuais;
\end_layout

\begin_layout Alineas
O plano de controle, usado para executar o Protocolo de Árvore Geradora
 (STP), que calcula a árvore geradora mínima para a rede local, prevenindo
 que repetições infinitas quebrem a rede;
\end_layout

\begin_layout Alineas
O plano de encaminhamento, responsável por processar quadros que entram
 pela porta de rede, fazendo uma decisão sobre para qual das portas deve-se
 encaminhá-los;
\end_layout

\begin_layout Alineas
O aprendizado de endereços de Controle de Acesso ao Meio (MAC) 
\begin_inset CommandInset citation
LatexCommand cite
key "noauthor_ieee_2016"

\end_inset

 mantém registrado em um banco de dados (tabela) a porta de rede na qual
 o endereço MAC está conectado, e portanto, servindo de consulta para encaminhar
 quadros para seu destinatário.
 Caso não conste o endereço, o quadro é enviado para todas as portas exceto
 a de origem.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Estrutura das interfaces virtuais de rede no Linux Bridge
\begin_inset CommandInset label
LatexCommand label
name "fig:Estrutura-das-interfaces-bridge"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/vif_bridge.png
	lyxscale 90
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Adaptado de 
\begin_inset CommandInset citation
LatexCommand cite
key "noauthor_xen_nodate"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
A título de descrição, a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Estrutura-das-interfaces-bridge"

\end_inset

 retrata o conjunto de portas de um 
\shape italic
switch
\shape default
 virtual.
 Ele possui quatro portas ocupadas, sendo duas com interfaces virtuais de
 duas VMs convidadas (
\family typewriter
vif4.0
\family default
 e 
\family typewriter
vif7.0
\family default
), uma porta com a interface física do hospedeiro (
\family typewriter
eth0
\family default
) para comunicação externa a camada de virtualização, e por último uma porta
 conectada ao elemento de rede que identifica o comutador conectado.
 Este último recebe um endereço do Protocolo de Internet (IP) 
\begin_inset CommandInset citation
LatexCommand cite
key "rfc791"

\end_inset

 caso queira que o hospedeiro esteja conectado a rede dos convidados.
\end_layout

\begin_layout Standard
Dada o comutador virtual criado e configurado por um assistente como o 
\family typewriter
brctl
\family default
 no GNU/Linux, um conjunto de quadros pode ser lançado da VM 
\family typewriter
dom4
\family default
 para a 
\family typewriter
dom7
\family default
 através da camada de enlace.
 Dado o conjunto de portas, os quadros trafegam como esperado a partir do
 momento que: o plano de controle não detecta caminhos circulares; o plano
 de encaminhamento solicita a informação sobre qual porta enviar o fluxo
 para a 
\family typewriter
dom7
\family default
 e recebe-a do plano de aprendizado de MACs.
\end_layout

\begin_layout Standard
Após realizar as configurações, a comunicação entre as duas máquinas virtuais
 se dá da seguinte forma: 
\family typewriter
dom4
\family default
 envia quadros através da sua interface de rede de saída, entrando então
 na interface virtual 
\family typewriter
vif4.0
\family default
, que por sua vez os encaminha automaticamente para o processamento dos
 componentes do 
\shape italic
switch
\shape default
 citados anteriormente.
 Tendo o destino sido detectado na porta a qual se conecta a 
\family typewriter
vif7.0
\family default
, o 
\shape italic
switch
\shape default
 encaminha os quadros até a sua entrada, que por sua vez encaminha automaticamen
te em saída para a interface de rede da VM.
 Um detalhe importante a se comentar é que todo esse tráfego é transparente
 para o hospedeiro, fazendo de sua segurança e isolamento algo primordial.
\end_layout

\begin_layout Standard
Uma das formas de anexar VMs ao 
\shape italic
switch
\shape default
 virtual criado é através dos arquivos de configuração de recursos das próprias.
 No caso do Xen, com as entradas 
\family typewriter
vif = [ ]
\family default
.
 Um exemplo simplificado é 
\family typewriter
vif=[ 'bridge=mybridge' ]
\family default
, onde o Xen atribui aleatoriamente um endereço MAC e conecta a máquina
 ao comutador virtual 
\family typewriter
mybridge
\family default
 
\begin_inset CommandInset citation
LatexCommand cite
key "noauthor_xen_nodate"

\end_inset

.
\end_layout

\begin_layout Chapter
ENTENDENDO CLICK E CLICKOS
\begin_inset CommandInset label
LatexCommand label
name "chap:ENTENDENDO-CLICKOS"

\end_inset


\end_layout

\begin_layout Standard
Este capítulo expôe de forma aprofundada as duas principais tecnologias
 utilizadas neste trabalho.
 Na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Click"

\end_inset

, Click é dissecado com detalhes sobre seu funcionamento, entregando uma
 literatura básica para que seja possível compreender e posteriormente desenvolv
er funções de rede a partir do zero.
 Alguns pequenos problemas encontrados durante o desenvolvimento deste trabalho
 também recebem destaque, junto com seu principal caso de uso atual no âmbito
 de NFV, e sua ferramenta de geração de grafos para maior visibilidade quando
 necessário.
 
\end_layout

\begin_layout Standard
Já na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:ClickOS"

\end_inset

, o mesmo detalhamento com relação a tecnologia ClickOS e seu uso é feito,
 mantendo o cuidado com a função de uma literatura de consulta para o leitor.
 Todo o processo para a instanciação de uma máquina virtual é citado, mesmo
 de forma ampla, deixando a implementação para capítulos posteriores.
 
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Click"

\end_inset

Click
\end_layout

\begin_layout Standard
A arquitetura Click foi idealizada por Robert Morris, Eddie Kohler e a equipe
 do Laboratório de Ciências da Computação do Instituto Tecnológico de Massachuse
tts (MIT) em 1999, que propuseram e desenvolveram uma plataforma em 
\shape italic
hardware
\shape default
 geral e em 
\shape italic
software
\shape default
 livre, para permitir o desenvolvimento de funções de rede sob demanda,
 e sem as limitações corriqueiramente impostas por soluções proprietárias
 em redes.
 Não há restrição de camadas ou protocolos de transmissão, bastando adicionar
 seu suporte, porém o foco está nas Camadas 2 e 3 do modelo OSI 
\begin_inset CommandInset citation
LatexCommand cite
key "day_osi_1983"

\end_inset

, com diversas operações na Camada 4.
\end_layout

\begin_layout Standard
Click trabalha com uma unidade chamada elemento.
 Ele representa a execução de uma atividade programada (classe) no pacote
 recebido, como 
\family typewriter
Tee
\family default
 na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Descrição-gráfica-de"

\end_inset

 recebe quadros e cria uma cópia (parâmetro de valor 2).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Descrição gráfica de um elemento em Click
\begin_inset CommandInset label
LatexCommand label
name "fig:Descrição-gráfica-de"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/click_element.png
	scale 65

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Adaptado de 
\begin_inset CommandInset citation
LatexCommand cite
key "morris_click_1999"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Fazem parte do projeto cerca de trezentos elementos pré-implementados pelos
 desenvolvedores e parceiros, em código aberto, e podem ser alterados conforme
 desejado desde que o editor tenha conhecimentos em C++ 
\begin_inset CommandInset citation
LatexCommand cite
key "morris_click_1999,Stroustrup:2013:CPL:2543987"

\end_inset

.
\end_layout

\begin_layout Standard
Uma lista não extensa desses elementos com base na documentação do Click
 disponível 
\begin_inset CommandInset citation
LatexCommand cite
key "kohler_click:_2018"

\end_inset

 é apresentada a seguir:
\end_layout

\begin_layout Alineas
Protocolo Ethernet: 
\family typewriter
EtherEncap, EtherSwitch, EtherVLANEncap,
\begin_inset Newline newline
\end_inset

SetEtherAddress
\family default
;
\end_layout

\begin_layout Alineas
Protocolo ARP: 
\family typewriter
ARPQuerier, ARPResponder; ARPTable; CheckARPHeader
\family default
;
\end_layout

\begin_layout Alineas
Protocolo IPv4: 
\family typewriter
CheckIPHeader, IPEncap, IPFragmenter, SetIPAddress, SetIPChecksum
\family default
;
\end_layout

\begin_layout Alineas
Protocolo IPv6: 
\family typewriter
CheckIP6Header, SetIP6Address, ProtocolTranslator64, ProtocolTranslator46
\family default
;
\end_layout

\begin_layout Alineas
Classificadores: 
\family typewriter
Classifier, IPClassifier
\family default
;
\end_layout

\begin_layout Alineas
Roteamento: 
\family typewriter
StaticIPLookup, LinearIPLookup, DirectIPLookup,
\begin_inset Newline newline
\end_inset

IPRouteTable
\family default
;
\end_layout

\begin_layout Alineas
NAT: 
\family typewriter
IPRewriter, ICMPRewriter, TCPRewriter, RoundRobinIPMapper,
\begin_inset Newline newline
\end_inset

SourceIPHashMapper
\family default
;
\end_layout

\begin_layout Alineas
Modelagem de tráfego (
\shape italic
traffic shaping
\shape default
): 
\family typewriter
BandwidthShaper, RatedSplitter, BandwidthRatedSplitter, Shaper
\family default
;
\end_layout

\begin_layout Alineas
Escalonamento (
\shape italic
scheduling
\shape default
): 
\family typewriter
PrioSched, RoundRobinSched
\family default
;
\end_layout

\begin_layout Alineas
Gerenciamento de filas: 
\family typewriter
RED
\family default
 (Detecção Adiantada Randômica), 
\family typewriter
CoDel
\family default
 (Controlled Delay);
\end_layout

\begin_layout Alineas
Redes sem Fio: 
\family typewriter
WifiEncap, WifiDecap, WirelessInfo, BeaconScanner,
\begin_inset Newline newline
\end_inset

OpenAuthRequeser
\family default
.
\end_layout

\begin_layout Standard
Esses e muitos outros elementos devem ser conectados a outros como em um
 grafo, permitindo o fluxo de pacotes.
 A junção de vários desses elementos obedecendo uma lógica cria uma VNF
 qualquer, tais como um 
\shape italic
firewall
\shape default
, um balanceador de carga, ou qualquer outro processador de pacotes.
\end_layout

\begin_layout Standard
A reutilização de código é visível, porém a legibilidade é tão importante
 quanto.
 Para isso, a ferramenta dispõe de uma linguagem marcação própria que esconde
 sua linguagem de programação base.
 Ela evidencia uma visão em grafos de fluxo, onde os elementos são nós e
 as arestas são as conexões por onde fluem os pacotes.
 Cada elemento possui especificações sobre o número de portas de entrada
 e saída, que devem ser conectadas no decorrer da implementação, no arquivo
 da função virtual.
 Veja a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Descrição-gráfica-de"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Condicionador-de-tráfego"

\end_inset

 e a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Uma-aplicação-dos"

\end_inset

 para exemplos.
\end_layout

\begin_layout Standard
Falando sobre portas, elas podem ser do tipo de fluxo 
\shape italic
pull
\shape default
 ou 
\shape italic
push
\shape default
, imitando a relação produtor-consumidor presente em sistemas distribuídos.
 Os elementos com portas 
\shape italic
pull
\shape default
 aguardam um sinal para enviar quadros ou requisitam através de um para
 receber outros do seu elemento vizinho.
 Já as portas 
\shape italic
push
\shape default
 possuem um comportamento de envio indiscriminado, e portanto, os elementos
 que as utilizam devem estar sempre disponíveis para receber pacotes ou
 eles se perdem.
 Por fim, há portas chamadas agnósticas, que assumem o comportamento do
 fluxo de processamento predominante 
\begin_inset CommandInset citation
LatexCommand cite
key "morris_click_1999"

\end_inset

.
 Veja a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Condicionador-de-tráfego"

\end_inset

 para uma melhor visualização.
\end_layout

\begin_layout Standard
A existência de ambos se dá pela natureza do uso de uma rede de alta velocidade
 compartilhada como as redes 
\shape italic
Ethernet
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "noauthor_ieee_2016"

\end_inset

: esvazie seu 
\shape italic
buffer
\shape default
 de entrada de quadros o mais rápido possível para que possa continuar recebendo
-os sem perdas; aguarde a sua vez para enviar os seus quadros à rede o mais
 rápido possível sem degradar outros pacotes.
 Desta forma, percebe-se que o mecanismo 
\shape italic
push
\shape default
 compõe o recebimento e o mecanismo 
\shape italic
pull
\shape default
 o envio.
 Já as filas, que são o único elemento capaz de converter o fluxo de 
\shape italic
push
\shape default
 para 
\shape italic
pull
\shape default
, são responsáveis por armazenar os pacotes processados mas impedidos de
 ir ao 
\shape italic
buffer
\shape default
 de saída do equipamento (rede bastante congestionada, com muito recebimento
 de quadros pelos dispositivos e por outro lado pouca saída).
\end_layout

\begin_layout Standard
Ainda em relação as portas, algumas regras devem ser obedecidas: olhando
 a partir de um elemento, uma dada porta de saída não pode ser conectada
 a várias portas de entrada de outros elementos, pois geraria efeito de
 duplicidade e inconsistência na rede; as portas de entrada do tipo pull
 não podem se conectar a mais de uma porta de saída; e nenhum outro elemento
 é capaz de converter tipos de fluxo exceto as filas, como comentado.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Condicionador de tráfego em Click
\begin_inset CommandInset label
LatexCommand label
name "fig:Condicionador-de-tráfego"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/click_traffic_cond.png
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: 
\begin_inset CommandInset citation
LatexCommand cite
key "morris_click_1999"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Dado os parâmetros do elemento classificador (
\family typewriter
Classifier
\family default
), os pacotes que entram nele com diferentes características possuem quatro
 caminhos:
\end_layout

\begin_layout Alineas
Primeiro um chaveador de fluxo (
\family typewriter
Meter
\family default
) que limita em no máximo 7500 quadros por segundo o fluxo, sendo ele despejado
 em uma fila caso respeite a taxa ou então descartado caso exceda, pela
 outra porta de saída em direção ao 
\family typewriter
Discard
\family default
;
\end_layout

\begin_layout Alineas
Depois, a segunda saída é acoplada a uma fila e a um elemento limitador
 de fluxo (
\family typewriter
Shaper
\family default
), que solicita pacotes a uma taxa de no máximo 10000 quadros por segundo
 através de sua porta 
\shape italic
pull
\shape default
;
\end_layout

\begin_layout Alineas
Quase no fim, a terceira saída se conecta a outro chaveador de fluxo, dessa
 vez com 12500 quadros por segundo sendo despejados em uma outra fila diferente
 caso respeite o limite, ou então a passagem para o elemento que marca o
 campo de serviços diferenciados do cabeçalho IP para o valor 4, antes de
 despejar esse mesmo fluxo em uma quarta fila;
\end_layout

\begin_layout Alineas
Por último, a quarta saída conecta-se diretamente a mesma fila que o ramo
 anterior na condição de fluxo maior que 12500 se conecta.
 
\end_layout

\begin_layout Standard
O percurso dos três primeiros caminhos terminam em um escalonador do tipo
 
\shape italic
Round Robin
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "RASMUSSEN2008617"

\end_inset

, que após seu processamento, este ainda sofre o processamento de outro
 escalonador baseado em prioridade ordenada, onde a primeira entrada tem
 precedência sobre as seguintes e assim segue da esquerda para a direita.
 Ao fim, os pacotes saem pela interface escolhida no elemento de envio (
\family typewriter
ToDevice
\family default
).
\end_layout

\begin_layout Standard
Ainda sobre a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Condicionador-de-tráfego"

\end_inset

, ao passar pelas filas a coloração das portas muda, indicando a mudança
 de fluxo de processamento de 
\shape italic
push
\shape default
 para 
\shape italic
pull
\shape default
.
 Outra observação interessante é quanto à fila do quarto caminho, que recebe
 as saídas de processamento de dois elementos, evidenciando que as portas
 de entrada 
\shape italic
push
\shape default
, ao contrário das portas 
\shape italic
pull
\shape default
, podem receber fluxos de múltiplas portas de saída.
\end_layout

\begin_layout Standard
O exemplo acima possui uma visão em grafo.
 Já a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Uma-aplicação-dos"

\end_inset

 demonstra através da linguagem de marcação do Click uma estrutura mínima
 para atuar sobre o protocolo IP, tendo o protocolo 
\shape italic
Ethernet
\shape default
 e ARP na camada inferior: 
\end_layout

\begin_layout Alineas
Todos os momentos onde :: é utilizado significam uma declaração de nome
 para o elemento criado.
 Toda vez que uma 
\family typewriter
->
\family default
 é utilizada significa uma ligação entre a porta de saída X e a porta de
 entrada Y de dois elementos, fluindo nesse sentido;
\end_layout

\begin_layout Alineas
O 
\family typewriter
AddressInfo
\family default
 é como um banco de dados rústico, utilizado para guardar dados sobre um
 dispositivo e usar uma macro para representá-los;
\end_layout

\begin_layout Alineas

\family typewriter
FromDevice
\family default
 e 
\family typewriter
ToDevice
\family default
 fazem respectivamente o recebimento dos quadros do 
\shape italic
buffer
\shape default
 de rede de entrada e o envio de outros para o 
\shape italic
buffer
\shape default
 de rede de saída;
\end_layout

\begin_layout Alineas
O 
\family typewriter
Classifier
\family default
 classifica os quadros com base na comparação de valores presentes nos cabeçalho
s, onde os dois primeiros parâmetros do exemplo são códigos referentes aos
 dados do protocolo ARP 
\begin_inset CommandInset citation
LatexCommand cite
key "rfc826"

\end_inset

 (consulta e resposta, respectivamente), o terceiro parâmetro contém o código
 para os pacotes com cabeçalho IP e o quarto para todos os outros.
 A análise do cabeçalho é feita de forma que o elemento procura um valor
 dos campos do cabeçalho em determinado 
\shape italic
Byte
\shape default
 do quadro, formando o par 
\shape italic
byte
\shape default
/valor.
 Em caso de mais de um par, a procura se torna mais específica, buscando
 casar mais de um valor no 
\shape italic
Byte
\shape default
 indicado, o que no caso do exemplo é a diferença entre um quadro de consulta
 e outro de resposta ARP;
\end_layout

\begin_layout Alineas

\family typewriter
ARPQuerier
\family default
 e 
\family typewriter
ARPResponder
\family default
 realizam o papel de preencher a tabela ARP de um dispositivo.
 O primeiro, diante da não existência de uma entrada para o destino solicitado
 por um pacote, consulta ao 
\family typewriter
ARPResponder
\family default
 de todos os dispositivos na rede acerca do endereço MAC associado a um
 dado endereço IP, e ao receber a resposta, encapsula o pacote em um quadro.
 O mesmo vale quando o portão (
\shape italic
gateway
\shape default
) se torna o destinatário temporário, o que acontece quando o 
\family typewriter
SetIPAddress
\family default
 é usado (detalhes no 
\begin_inset CommandInset ref
LatexCommand formatted
reference "chap:PROJETO-E-IMPLEMENTAÇÃO"

\end_inset

), por exemplo.
 Como exemplificado, o 
\family typewriter
ARPResponder
\family default
 responde às consultas feitas por outros dispositivos com algo similar ao
 
\family typewriter
ARPQuerier
\family default
 e pode ser utilizado para realizar um 
\shape italic
Proxy
\shape default
 ARP 
\begin_inset CommandInset citation
LatexCommand cite
key "rfc1027"

\end_inset

;
\end_layout

\begin_layout Alineas

\family typewriter
Queue
\family default
 define uma fila para receber os pacotes em fluxo 
\shape italic
push
\shape default
 para entregá-los quando solicitado pelos elementos do fluxo 
\shape italic
pull
\shape default
.
 Nesse exemplo contém 200 entradas mas deve ser dimensionado para mitigar
 perdas de pacotes;
\end_layout

\begin_layout Alineas
Conexões entre: 
\family typewriter
FromDevice
\family default
 e o 
\family typewriter
Classifier
\family default
; 
\family typewriter
Queue
\family default
 e 
\family typewriter
ToDevice
\family default
; as requisições ARP vindas do 
\family typewriter
Classifier
\family default
 e o 
\family typewriter
ARPResponder
\family default
; deste último e a 
\family typewriter
Queue
\family default
; as respostas ARP vindas do 
\family typewriter
Classifier
\family default
 e a porta de entrada 1 do 
\family typewriter
ARPQuerier
\family default
; de um elemento de controle de erro (
\family typewriter
Idle
\family default
) e a entrada 0 do 
\family typewriter
ARPQuerier
\family default
 para evitar mensagens de erro, e a conexão deste mesmo elemento a fila
 para escoar os pacotes encapsulados;
\end_layout

\begin_layout Alineas
Os pacotes IP classificados no 
\family typewriter
Classifier
\family default
 saem pela porta 2 e então podem ser modificados como desejado.
 Não é necessário inserir todos os códigos no bloco indicado para preenchimento,
 desde que ao fim se conectem desse ponto até o último elemento.
 Esse aliás, deve se conectar ao 
\family typewriter
ARPQuerier
\family default
 para que os pacotes sejam encapsulados e sigam o caminho até o elemento
 que proporciona a saída da rede; 
\end_layout

\begin_layout Alineas
Os demais pacotes saem pela porta 3 e são descartados ao ligar tal saída
 do 
\family typewriter
Classifier
\family default
 ao 
\family typewriter
Discard
\family default
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Uma aplicação dos elementos mínimos para ações sobre o protocolo IP
\begin_inset CommandInset label
LatexCommand label
name "fig:Uma-aplicação-dos"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/clickos_arquivoBase.png
	scale 63

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Todos os elementos podem ser consultados na documentação oficial do Click
 em 
\begin_inset CommandInset citation
LatexCommand cite
key "kohler_click:_2018"

\end_inset

 para um melhor entendimento.
 Outra fonte interessante são os livros, artigos, padronizações e textos
 técnicos sobre o uso dos protocolos de rede como por exemplo as Requisições
 Para Comentários (RFCs) do IETF.
 Muitos deles são referenciados por este trabalho.
\end_layout

\begin_layout Standard
A linguagem de marcação de Click possui um analisador que encontra erros
 de sintaxe e semântica em tempo de execução para auxilio no desenvolvimento.
 Na mesma linha, a ferramenta disponibiliza manipuladores de elementos (
\shape italic
element handlers
\shape default
) básicos para que seja possível analisar comportamentos indesejados em
 tempo de execução.
 Um exemplo é a tabela 
\family typewriter
tcp_table
\family default
 do Protocolo de Controle de Transmissão (TCP) 
\begin_inset CommandInset citation
LatexCommand cite
key "rfc793"

\end_inset

 disponibilizada pelo elemento de NAT (IPRewriter), que pode indicar o correto
 funcionamento ou não de uma VNF que utilize seu elemento.
 Outros manipuladores são capazes de alterar determinadas variáveis em tempo
 de execução, embora isso seja incomum.
 Por exemplo, o manipulador 
\family typewriter
capacity
\family default
 altera o tamanho da tabela de regras do mesmo 
\family typewriter
IPRewriter
\family default
.
 De qualquer forma, Click permite a implementação de outros manipuladores
 para os elementos dado um conhecimento em C++.
 Para consultar quais manipuladores estão implementados, basta utilizar
 a documentação citada.
\end_layout

\begin_layout Standard
Outra forma de facilitar a correção de erros, e também facilitar o entendimento
 de uma implementação em Click é através do uso da ferramenta de geração
 de grafos distribuída com Click chamada Clicky.
 Ela transforma elementos e portas em uma representação gráfica de um grafo,
 baseado em um arquivo de Folhas de Estilo em Cascata (CSS), e também é
 capaz de analisar erros e retorná-los.
 Na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Interface-gráfica-e"

\end_inset

, pode-se ver o grafo em Clicky, representando o código descrito na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Uma-aplicação-dos"

\end_inset

, exceto o ramo da porta de saída 2 do classificador (em vermelho) que se
 encontra fora dos padrões da linguagem por conta das barras (
\family typewriter
/ /
\family default
) usadas para destacar uma ação a ser tomada pelo desenvolvedor da função,
 gerando erro.
 É possível exportar tais grafos para documentos ou imagens.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Interface gráfica e grafo padrão da 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Uma-aplicação-dos"

\end_inset

 em Clicky
\begin_inset CommandInset label
LatexCommand label
name "fig:Interface-gráfica-e"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/clicky-iface.png
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Durante o desenvolvimento deste trabalho, algumas limitações nos elementos
 foram observadas: 
\end_layout

\begin_layout Alineas
Para criar balanceadores de carga, os elementos existentes são limitados
 ao mecanismo de 
\shape italic
Round Robin
\shape default
 (
\family typewriter
RoundRobinIPMapper
\family default
) e ao mecanismo de distribuição por IP de origem (
\family typewriter
SourceIPHashMapper
\family default
), sem uma análise de carga dos servidores que recebem o balanceamento,
 através do SNMP 
\begin_inset CommandInset citation
LatexCommand cite
key "rfc1157"

\end_inset

, por exemplo; 
\end_layout

\begin_layout Alineas
A tabela TCP criada no NAT através dos elementos acima não se apaga como
 deveria 
\begin_inset CommandInset citation
LatexCommand cite
key "kohler_modular_2002"

\end_inset

 devido a um erro de implementação que reinicia o contador responsável por
 sua expiração, e pode assim criar instabilidade quanto aos balanceamentos.
 Desta forma os balanceadores só garantem o balanceamento em tempo de criação
 da regra, e uma vez que elas permaneçam indefinidamente, determinadas conexões
 perenes podem desbalancear o sistema, já que não seriam rebalanceadas.
 Este erro foi reportado a comunidade, mas não a tempo de ser corrigido
 para este trabalho;
\end_layout

\begin_layout Alineas
A manipulação de mensagens do Protocolo de Datagrama do Usuário (UDP) 
\begin_inset CommandInset citation
LatexCommand cite
key "rfc768"

\end_inset

 maiores que o Tamanho de Seguimento Máximo (MSS) deste é um problema quando
 se desenvolve um NAT em Click, já que para o recálculo da soma de verificação
 (
\shape italic
checksum
\shape default
) usando o 
\family typewriter
UDPChecksum
\family default
, seria necessário remontar a mensagem UDP 
\begin_inset CommandInset citation
LatexCommand cite
key "rfc768"

\end_inset

, o que Click não disponibiliza, comprometendo o desenvolvimento de alguma
 função de rede nessa situação;
\end_layout

\begin_layout Alineas
Estranhamente um elemento somente leitura com relação aos pacotes como o
 
\shape italic
firewall
\shape default
 (
\family typewriter
IPFilter
\family default
) em Click causa erros em transmissão de mensagens TCP caso o encadeamento
 não possua o 
\family typewriter
SetTCPChecksum
\family default
, e o destinatário verifique o campo de soma de verificação.
 Essa característica é comum após o uso de elementos que reescrevam os cabeçalho
s como o 
\family typewriter
IPRewriter
\family default
, mas não com um filtro.
\end_layout

\begin_layout Standard
Click possui um módulo para operar em espaço de 
\shape italic
kernel
\shape default
 do Linux, em substituição ao módulo do sistema operacional.
 Isso significa um desempenho maior em relação a sua execução em espaço
 de usuário.
 É em espaço de 
\shape italic
kernel
\shape default
 que os desenvolvedores, à época, conseguiram desempenho próximo ao módulo
 padrão do Linux 
\begin_inset CommandInset citation
LatexCommand cite
key "morris_click_1999"

\end_inset

.
 No entanto, atualmente o módulo do Click, encontra-se bastante defasado,
 compatibilizando apenas com a versão do 
\shape italic
kernel
\shape default
 Linux 2.6, em face da versão 4.16 atual.
 Esta defasagem faz com que seu uso em um sistema operacional tradicional
 seja desestimulado, devido a complexidade em se programar para essa parte
 de um sistema.
 Seu uso atual possui escopo em 
\shape italic
middleboxes
\shape default
 virtualizados, como em ESCAPE 
\begin_inset CommandInset citation
LatexCommand cite
key "csoma_escape:_2014"

\end_inset

, CliMB 
\begin_inset CommandInset citation
LatexCommand cite
key "laufer_climb:_2016"

\end_inset

, ClickOS 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

 (ver 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:ClickOS"

\end_inset

) e outros não relacionados a um 
\shape italic
kernel
\shape default
 como para o Kit de Desenvolvimento em Plano de Dados (DPDK) com FastClick
 
\begin_inset CommandInset citation
LatexCommand cite
key "barbette_fast_2015"

\end_inset

.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:ClickOS"

\end_inset

ClickOS
\end_layout

\begin_layout Standard
ClickOS é parte de um projeto de pesquisa da Universidade Politécnica de
 Bucareste junto com a Companhia Elétrica Nipônica na Europa (NEC Europe)
 para o provisionamento de VNFs que possam substituir 
\shape italic
middleboxes
\shape default
 em 
\shape italic
hardware
\shape default
.
 Ele se encontra representado no modelo NFV pela camada de virtualização,
 gerenciando localmente as funções virtuais de rede.
 Trata-se primeiramente de um sistema operacional baseado em Click, focado
 em alta vazão, baixo atraso e isolamento 
\begin_inset CommandInset citation
LatexCommand cite
key "bondan_management_2014"

\end_inset

.
 Porém seus criadores objetivam também uma plataforma de alta performance
 com flexibilidade, escalabilidade e reúso de código no topo de hardwares
 de propósito geral 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

.
 
\end_layout

\begin_layout Standard
Para a alcunha de plataforma fazer sentido, ClickOS ultrapassa os limites
 de um sistema operacional para micro-máquinas virtuais.
 Ele se apoia no Projeto Xen e no VALE 
\shape italic
Switch
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "rizzo_vale_2012"

\end_inset

 e propõe mudanças significativas as estruturas de ambos ao aglutiná-los.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Arquitetura inicial presente no ClickOS
\begin_inset CommandInset label
LatexCommand label
name "fig:Arquitetura-inicial-presente"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/clickos_arch.png
	scale 42

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Arquitetura-inicial-presente"

\end_inset

, é possível ver detalhes das entidades que compõem ClickOS sem uma otimização.
 Nela é possível ver as relações entre os itens de rede em espaço de 
\shape italic
kernel
\shape default
 como o 
\shape italic
driver
\shape default
 de rede da máquina hospedeira, o 
\shape italic
switch
\shape default
 em 
\shape italic
software
\shape default
, interface virtual de rede, 
\shape italic
netback
\shape default
, 
\shape italic
netfront
\shape default
, até a função virtual de rede.
 Também é visível os itens de administração e interação com o operador,
 como o comando 
\family typewriter
xl
\family default
 e o 
\family typewriter
cosmos
\family default
.
\end_layout

\begin_layout Standard
No tocante as mudanças da arquitetura inicial, algumas se destacam a partir
 de 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

: o acesso aos pacotes recebeu uma atenção especial ao remover intermediários
 da comunicação entre as máquinas virtuais e o 
\shape italic
switch
\shape default
 virtual como o 
\shape italic
driver
\shape default
 
\shape italic
netback
\shape default
, que passou a ter um papel de controle apenas.
 Já o 
\shape italic
driver
\shape default
 
\shape italic
netfront
\shape default
 associado as VMs foi reprogramado para colocar na memória de suas VMs os
 respectivos 
\shape italic
buffers
\shape default
 da porta do 
\shape italic
switch
\shape default
.
 Por fim, as interfaces virtuais do Xen (
\shape italic
vifs
\shape default
) foram ignoradas e então removidas.
 Ver 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Antes-e-depois"

\end_inset

.
\end_layout

\begin_layout Standard
O VALE 
\shape italic
Switch
\shape default
, dispositivo de comutação virtual apresentado por Luigi Rizzo e Giuseppe
 Lettieri da Universidade de Pisa é usado para interconectar máquinas virtuais
 em redes a partir da API Netmap 
\begin_inset CommandInset citation
LatexCommand cite
key "rizzo_revisiting_2012"

\end_inset

.
 Ele entra na plataforma substituindo o pouco otimizado OpenVSwitch e ao
 fim é alterado para que forneça acesso direto dos 
\shape italic
buffers
\shape default
 de suas portas para o 
\shape italic
netfront
\shape default
 de cada VM, e para que aumente-se seu número de portas visando atender
 mais VNFs 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

.
 O conjunto de mudanças estimulou a renomeação para ClickOS 
\shape italic
Switch
\shape default
 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Antes e depois das alterações mencionadas
\begin_inset CommandInset label
LatexCommand label
name "fig:Antes-e-depois"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/xen_network_io_scheme.png
	lyxscale 85
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Adaptado de 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
A escolha por Click para integrar a plataforma deve-se a flexibilidade e
 o reúso de código mencionados nos objetivos dos criadores e abordados na
 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Click"

\end_inset

.
 ClickOS constrói seu sistema operacional a partir do MiniOS: um 
\shape italic
micro-kernel
\shape default
 de sistema operacional minimalista voltado para um processamento quase
 monoprocessado, escalável, e de baixa carga de uso de CPU, criado pelos
 desenvolvedores do Xen.
 A adaptação de Click ao 
\shape italic
micro-kernel
\shape default
 do MiniOS, inclusive portando as bibliotecas necessárias sua construção
 neste sistema, resultou em um 
\shape italic
kernel
\shape default
 ainda enxuto, que dentro de uma micro-VM consume 5MB de memória ao executar,
 sendo instanciável em 30ms, provocando um atraso na rede de 45
\begin_inset Formula $\mu$
\end_inset

s, não necessitando de disco e alcançando uma vazão de 10Gbps 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

.
 Este desempenho confirma as caracteristicas atribuídas a ele no inicio
 desta seção.
\end_layout

\begin_layout Standard
Para instanciar as VNFs, ClickOS usa o método disponibilizado pelo Xen,
 através de um arquivo de configuração, onde é possível descrever itens
 como quantidade de processadores, memória, interfaces virtuais de rede,
 comportamento de falhas e o nome da função virtual.
 Ver 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Exemplo-de-arquivo-cfg"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Exemplo de arquivo de configuração de uma VNF
\begin_inset CommandInset label
LatexCommand label
name "fig:Exemplo-de-arquivo-cfg"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/vnf_xen_config.png
	scale 63

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
É importante dizer que os dados sobre as redes conectadas devem estar de
 acordo com os dados atribuídos a VNF no código de Click para não haver
 enganos e erros.
 Muito cuidado ao gerar endereços MAC ou IP, pois existem classes e restrições
 em ambos 
\begin_inset CommandInset citation
LatexCommand cite
key "noauthor_ieee_2016,rfc3330,rfc5737"

\end_inset

.
\end_layout

\begin_layout Standard
O segundo passo da criação de VNFs em ClickOS passa pelo uso do gerente
 de pilha próprio da plataforma chamado Cosmos.
 Ele recebe o código Click e a identificação da VM criada com o 
\shape italic
kernel
\shape default
 ClickOS para inserir o primeiro no segundo, transformando-o em uma VNF.
\end_layout

\begin_layout Standard
Elas não possuem entrada em linha de comando para seu gerenciamento próprio,
 sendo esse um papel da máquina hospedeira.
 No momento da implantação das funções a partir do hospedeiro, não há passagem
 de parâmetros em tempo de inicialização.
 Apenas algumas operações de leitura e escrita em tempo de execução são
 permitidas, através dos manipuladores descritos na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Click"

\end_inset

, que podem ser acionados através do hospedeiro com o Cosmos, mas muito
 longe de ser um suporte consistente a configurações em tempo de execução
 como uma adição de regras em um 
\shape italic
firewall
\shape default
 ou uma remoção de servidor no balanceador de carga.
 Para contornar essa limitação, scripts de marcação de texto podem ser utilizado
s a parte para gerar os arquivos na linguagem de Click e recarregar a função
 de rede, mesmo que signifique uma queda repentina do serviço associado.
\end_layout

\begin_layout Standard
Apesar de não possuir linha de comando, as máquinas virtuais com o núcleo
 do ClickOS exibem um registro de alertas e erros exibido pelo comando 
\family typewriter
xl console
\family default
, que pode reportar erros de codificação de todos os níveis, erros de inicializa
ção, má configuração.
 É possível também verificar a carga delas através do comando 
\family typewriter
xentop
\family default
, tomando cuidado para um pequeno erro que faz os valores decrescerem de
 cem por cento para zero ao invés do comportamento costumeiro.
\end_layout

\begin_layout Standard
Como 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

 demonstra, ClickOS sofre com um problema comum a essas soluções e que é
 alvo de pesquisas no momento: a queda de desempenho ao encadear VNFs uma
 após a outra para prover um serviço mais completo.
 Uma das soluções para amenizar esse efeito está presente no 
\shape italic
zero-copy
\shape default
 do OpenNetVM 
\begin_inset CommandInset citation
LatexCommand cite
key "yurchenko_opennetvm:_2018"

\end_inset

, mas ClickOS, um projeto de quatro anos em relação ao anterior, ainda não
 possui algo do tipo.
\end_layout

\begin_layout Standard
Por fim, ClickOS pode trabalhar em conjunto com soluções NFV através de
 uma integração com o VIM da solução.
 São exemplos já implementados o OpenStack e o Nomad 
\begin_inset CommandInset citation
LatexCommand cite
key "ventre_performance_2016"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
anexo de comandos
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Chapter
PROJETO E IMPLEMENTAÇÃO 
\begin_inset CommandInset label
LatexCommand label
name "chap:PROJETO-E-IMPLEMENTAÇÃO"

\end_inset


\end_layout

\begin_layout Standard
A partir dos conceitos apresentados, este capítulo propõe, projeta e implementa
 duas funções virtuais de rede, motivado pelos benefícios da camada de virtualiz
ação no âmbito de servidores e redes com seus dispositivos.
 As características atribuídas ao ClickOS e ao Click na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:ClickOS"

\end_inset

 e 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Click"

\end_inset

, incentivam um desenvolvimento de VNFs a partir de uma visão macro em relação
 àquela vista em linguagens de programação, sem associar-se apenas ao ensino
 de redes em mais alto nível, uma vez que em determinado momento é capaz
 de entregar desempenho satisfatório segundo seus autores, inclusive sendo
 habilitável ao NFV.
\end_layout

\begin_layout Standard
A partir desse incentivo, este trabalho projeta e implementa duas funções
 a título de prova.
 As funções escolhidas são um 
\shape italic
firewall
\shape default
 (
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Firewall"

\end_inset

) e um balanceador de carga (
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Balanceador-de-Carga"

\end_inset

) em uma rede com 
\shape italic
Ethernet
\shape default
, TCP/IP.
 A escolha se deve pela boa legibilidade e assimilação de suas funções mais
 importantes, já que são facilmente encontrados nas infraestruturas da Tecnologi
a da Informação.
 Nesta proposta, o 
\shape italic
firewall
\shape default
 precede o balanceador de carga sem nós intermediários.
\end_layout

\begin_layout Standard
Espera-se que a curva de aprendizado da ferramenta seja melhor a partir
 dessas funções.
 Foge o escopo deste trabalho demonstrar VNFs complexas.
 Um resumo do proposto pode ser visto na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Um-dia-dentro"

\end_inset

.
\end_layout

\begin_layout Standard
Tanto o 
\shape italic
firewall
\shape default
 quanto o balanceador de carga possuem elementos mínimos para seu funcionamento,
 como é o caso daqueles relacionados a camada física e de enlace, composta
 pelos elementos 
\family typewriter
FromDevice
\family default
, 
\family typewriter
ToDevice
\family default
, 
\family typewriter
Classifier
\family default
, 
\family typewriter
ARPQuerier
\family default
 e 
\family typewriter
ARPResponder
\family default
 (ver seus usos na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Uma-aplicação-dos"

\end_inset

).
 Outros como 
\family typewriter
IPFilter
\family default
, 
\family typewriter
SetIPAddress
\family default
, 
\family typewriter
RoundRobinIPMapper
\family default
, 
\family typewriter
SourceIPHashMapper
\family default
, 
\family typewriter
IPRewriter 
\family default
e 
\family typewriter
SetTCPChecksum
\family default
 estão associados a tarefa de cada VNF de forma específica.
 Segue um detalhamento deles com base na documentação de 
\begin_inset CommandInset citation
LatexCommand cite
key "kohler_click:_2018"

\end_inset

:
\end_layout

\begin_layout Itemize

\family typewriter
IPFilter
\family default
: possui uma porta de entrada por onde passam pacotes IP, e duas de saída
 por onde saem fluxos permitidos e fluxos bloqueados.
 Ao invés deste último caso, há a possibilidade de ignorá-los, o que faz
 com que o fluxo não saia pela respectiva porta.
 O que define o caminho dos pacotes são as regras adicionadas nos parâmetros
 do elemento, com base na ação descrita.
 A comparação entre pacote e regra é feita de forma ordenada, logo as regras
 mais específicas devem estar antes das mais genéricas.
 Em um 
\shape italic
firewall
\shape default
 de produção, é comum que o padrão seja bloquear por padrão e aceitar as
 exceções, sendo que para reproduzir este comportamento, basta adicionar
 as regras de permissão antes da regra 
\family typewriter
deny all
\family default
 ou 
\family typewriter
drop all
\family default
, ao fim;
\end_layout

\begin_layout Itemize

\family typewriter
SetIPAddress
\family default
: possui uma porta de entrada e outra de saída.
 É o elemento para configurar o endereço da saída padrão (
\shape italic
gateway
\shape default
) da rede, usado para os pacotes cujo destino está a mais de um salto a
 partir da rede atual.
 Quando configurado, realiza uma anotação no pacote recebido que os elementos
 ARP usam encapsular o pacote IP.
 A anotação tem precedência sobre o endereço IP de destino presente no pacote
 no momento de busca pelo endereço MAC associado na tabela ARP.
 Assim, um pacote consegue saltar para as redes do 
\shape italic
gateway
\shape default
 em busca do seu destino, que por sua vez pode repetir a operação sucessivamente
 a um novo até que encontre-o;
\end_layout

\begin_layout Itemize

\family typewriter
RoundRobinIPMapper
\family default
: não possui portas.
 Serve como um anexo ao 
\family typewriter
IPRewriter
\family default
 para determinar qual regra deve ser utilizada no momento da reescrita de
 endereços IP e portas a ser feita por este.
 A determinação acontece seguindo um padrão de intervalo de tempo sem prioridade
 como é o escalonamento 
\shape italic
Round Robin
\shape default
.
 Ele permite que o 
\family typewriter
IPRewriter
\family default
 tente distribuir de maneira uniforme os pacotes que recebe;
\end_layout

\begin_layout Itemize

\family typewriter
SourceIPHashMapper
\family default
: na mesma linha do anterior, no entanto a regra utilizada nesse caso depende
 de uma função 
\shape italic
hash
\shape default
 para fazer a escolha dentre aquelas configuradas em seus parâmetros, fixando-a
 através do endereço IP de origem para que todos os pacotes provenientes
 do endereço tenham o mesmo endereço IP de destino, independentemente de
 outras variáveis como portas;
\end_layout

\begin_layout Itemize

\family typewriter
IPRewriter
\family default
: Um dos elementos mais complexos estudados por esse trabalho.
 Pode possuir quantas portas de entrada e saída for necessário.
 De forma geral, este elemento faz o papel de reescrever os cabeçalhos com
 relação aos endereços IP e portas de transporte, com base nas ações configurada
s em uma tabela, preenchida pelas regras inseridas nos parâmetros do elemento.
 Estas, por sua vez, são combinadas com portas, associando uma porta de
 entrada X ao parâmetro de índice X na lista de parâmetros configurados
 no elemento.
 Somente se os metadados do pacote não casem com uma ação previamente estabeleci
da por outra regra, o elemento cria essa ação e a aplica com base na regra
 do parâmetro associado àquela porta de entrada, atribuindo a porta de saída
 Y descrita na regra para o pacote alterado sair do elemento.
 O NAT costuma receber pacotes-resposta para aqueles que sofreram reescrita
 anteriormente, e por isso o 
\family typewriter
IPRewriter
\family default
 prontamente adiciona uma ação de retorno para que ele também reescreva
 o pacote-resposta, e este volte ao requerente através de outra porta de
 saída Z do elemento, configurada também nos parâmetros.
 Em suma, no 
\family typewriter
IPRewriter
\family default
 o desenvolvedor é responsável por gerir o fluxo e dizer onde eles devem
 entrar e sair, trazendo flexibilidade para a solução.
 Além das regras de reescrita, há outras regras que permitem ações padrão
 caso não haja casamento entre padrão e pacote naquela porta, como ignorar
 o pacote e simplesmente passar o pacote adiante em uma porta de saída desejada,
 inclusive nas portas já existentes.
 Há também a possibilidade de usar elementos anexos 
\family typewriter
SourceIPHashMapper
\family default
 e 
\family typewriter
RoundRobinIPMapper
\family default
, que armazenam suas regras com o mesmo padrão utilizado aqui.
 Para um exemplo concreto, veja a implementação do balanceador de carga
 na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Balanceador-de-Carga"

\end_inset

.
\end_layout

\begin_layout Itemize

\family typewriter
SetTCPChecksum
\family default
: com uma porta de entrada e outra de saída, este elemento é responsável
 por corrigir a soma de verificação do cabeçalho TCP, e garantir que os
 pacotes sejam considerados válidos pelas camadas de transporte que os recebem.
 É muito associado as saídas de um 
\family typewriter
IPRewriter
\family default
 para validar os pacotes alterados por ele.
\end_layout

\begin_layout Section
Um dia dentro das funções propostas
\begin_inset CommandInset label
LatexCommand label
name "sec:Um-dia-dentro"

\end_inset


\end_layout

\begin_layout Standard
Esta seção é destinada a explicar a sequência de ações que acontecem a um
 quadro quando entra no ambiente de funções virtuais de rede de ClickOS
 e possui a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Comportamento-esperado-das"

\end_inset

 como referência.
\end_layout

\begin_layout Standard
Um pacote criado por um cliente realiza uma requisição qualquer para o servidor.
 Dada a abstração para que o quadro chegue até o primeiro ponto de parada
 (
\shape italic
firewall
\shape default
), ele adentra a rede e entra na interface virtual do 
\shape italic
switch
\shape default
 virtual, que o comuta e o encaminha à interface de rede associada a VNF,
 que depois de passar pelo kernel do Xen, chega a interface virtual da função
 virtual.
 Nesse ponto o pacote é encaminhado para o 
\shape italic
buffer
\shape default
 de entrada presente no 
\shape italic
kernel
\shape default
 do ClickOS, que por sua vez permite que a VNF receba os quadros na interface
 de rede 0 através do elemento 
\family typewriter
FromDevice
\family default
.
 O elemento citado transmite o quadro para o classificador (
\family typewriter
Classifier
\family default
), que diante sua análise o transmite pela saída 2 ao verificar que se trata
 de um quadro 
\family typewriter
Ethernet
\family default
 com cabeçalho IP na camada mais interna.
 Logo a frente, seu cabeçalho Ethernet é removido (
\family typewriter
Strip
\family default
) e se torna um pacote, tendo seu cabeçalho IP é checado (
\family typewriter
CheckIPHeader
\family default
), para que posteriormente possa ser analisado pelo elemento base do 
\shape italic
firewall
\shape default
 (
\family typewriter
IPFilter
\family default
).
 Ao ser considerado apto para seguir, o pacote inicia o caminho de saída
 para o próximo nó do cenário entrando no elemento responsável por consultar
 o endereço MAC deste próximo nó, e então encapsular o pacote em um novo
 quadro (
\family typewriter
ARPQuerier
\family default
) e entregando a fila usada para armazenar os quadros enquanto o dispositivo
 de saída não está pronto (
\family typewriter
Queue
\family default
).
 O quadro só sai daqui quando o 
\shape italic
buffer
\shape default
 de saída estiver disponível, o que é feito pelo elemento 
\family typewriter
ToDevice
\family default
 enviando-o pela interface de rede 1, notabilizando uma possível rede diferente
 daquela de entrada.
 Então o pacote vai ao 
\shape italic
buffer
\shape default
 de saída da VNF e de lá para o Xen, para a interface virtual do 
\shape italic
switch
\shape default
 e para o 
\shape italic
switch
\shape default
 virtual que encaminha para a porta do próximo nó.
 Passagens: 1, 2 e parte do 3 na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Comportamento-esperado-das"

\end_inset

, e a descrição na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Código-fw"

\end_inset

.
\end_layout

\begin_layout Standard
O processo se repete para a entrada do pacote no balanceador de carga até
 a etapa de checagem do endereço IP, onde ele é entregue ao elemento responsável
 pelo processo de troca de endereços de destino no NAT (
\family typewriter
IPRewriter
\family default
).
 Aqui a troca é feita conforme o elemento configurado para balancear a carga
 (
\family typewriter
SourceIPHashMapper
\family default
 ou 
\family typewriter
RoundRobinIPMapper
\family default
).
 O pacote com IP de destino alterado entra pela porta de entrada 0 e pela
 regra escolhida sai pela porta de saída 0, onde a correção da soma de verificaç
ão do protocolo TCP o aguarda (
\family typewriter
SetTCPChecksum
\family default
), e logo após é enviado em direção ao encapsulamento do cabeçalho 
\shape italic
Ethernet
\shape default
, repetindo o todo o processo de saída da VNF pela interface de rede 1,
 e o processo para sua entrega ao proximo nó.
 Passagens: parte de 3, 4 e parte do 5 na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Comportamento-esperado-das"

\end_inset

, e a descrição na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Código-lb"

\end_inset

.
\end_layout

\begin_layout Standard
O próximo nó é o servidor, que assim como os outros recebe em sua interface
 de rede o quadro da interface virtual, adicionando-o ao 
\shape italic
buffer
\shape default
 de entrada que em um momento analisa o protocolo de transporte e entrega-o
 de acordo com o serviço conectado a porta de destino definida.
 O serviço então analisa o pacote recebido, e supondo que haja necessidade
 de resposta, o faz, o que ao fim gera um pacote-resposta na rede em sentido
 contrário, que inicialmente sai pelo 
\shape italic
buffer
\shape default
 de saída da interface de rede, passa pelo Xen, pela interface virtual do
 
\shape italic
switch
\shape default
 e chega ao 
\shape italic
switch
\shape default
 virtual, que reencaminha o pacote para a porta onde está a interface com
 o balanceador de carga.
 Passagens: parte do 5, 6 e parte do 7 na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Comportamento-esperado-das"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Comportamento esperado das VNFs propostas
\begin_inset CommandInset label
LatexCommand label
name "fig:Comportamento-esperado-das"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/undergrad-thesis-fw-lbdnat.png
	lyxscale 59
	scale 32

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
No sentido contrário, o quadro resposta faz um percurso parecido com aquele
 no sentido normal.
 As principais diferenças estão na chegada a partir da interface de rede
 1 e saída para o 
\shape italic
firewall
\shape default
 na interface de saída 0, e no elemento de NAT.
 Este último recebe o pacote do elemento de checagem de endereços pela porta
 de entrada 1 ao invés da porta 0, para que possa descartar o pacote caso
 não haja regra compatível.
 Pela regra gravada na fase de envio, o pacote resposta ao pacote original
 deve sair pela porta 1 do elemento após corretamente convertido para os
 IPs externos.
 Assim que sai pela porta 1, o pacote tem seu reprocessamento da soma de
 verificação como anteriormente, e depois recebe a anotação (
\family typewriter
SetIPAddress
\family default
) indicando que o pacote precisa passar por um 
\shape italic
gateway
\shape default
 no próximo nó para rumar ao seu destino final, que será usado pelo elemento
 de encapsulamento 
\family typewriter
ARPQuerier
\family default
.
 Todo o restante do processo no balanceador de carga é comum aos passos
 já mencionados.
 Passagens: parte do 7, 8 e parte de 9 na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Comportamento-esperado-das"

\end_inset

 e a descrição na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Código-lb"

\end_inset

.
\end_layout

\begin_layout Standard
Chegando ao 
\shape italic
firewall
\shape default
, o pacote resposta passa pelo mesmo procedimento mencionado no início,
 trocando as interfaces de rede em que entram e saem os pacotes: agora a
 entrada é pela interface 1 e a saída é pela interface 0, respectivamente.
 A partir deste ponto, retoma-se a abstração com relação a chegada do pacote
 resposta ao cliente.
 Passagens: parte do 9, 10, e 11, e a descrição na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Código-fw"

\end_inset

.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Firewall"

\end_inset

Firewall
\end_layout

\begin_layout Standard
A proposta aqui passa por realizar os bloqueios no nível da camada de roteamento
 e transporte.
 O elemento de Click responsável deve avaliar a quádrupla de endereços e
 portas de origem e destino para decidir com base nas regras implantadas
 a permissão ou não para seguir no fluxo, em modo sem estado (
\shape italic
stateless
\shape default
).
 Dada a lista de pacotes no fluxo exibida na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Exemplo-de-fluxo-fw"

\end_inset

 e a lista de regras na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Exemplo-de-regras-fw"

\end_inset

, o resultado esperado segue na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Resultado-do-processamento-fw"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Exemplo de fluxo de pacotes que vai ao 
\shape italic
firewall
\shape default

\begin_inset CommandInset label
LatexCommand label
name "tab:Exemplo-de-fluxo-fw"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#Pct
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IP origem
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Porta envio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IP destino
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Porta alvo
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
198.51.100.55
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
443
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
443
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
198.51.100.55
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
45045
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
198.51.100.55
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60365
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
21
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.0.2.237
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
53385
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22222
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22222
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.0.2.237
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
53385
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Exemplo de regras no 
\shape italic
firewall
\shape default

\begin_inset CommandInset label
LatexCommand label
name "tab:Exemplo-de-regras-fw"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="6">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#Regra
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IP origem
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Porta envio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IP destino
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Porta alvo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ação
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22222
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Aceitar
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.0/24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1024-65536
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.0/24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
21
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Aceitar
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.0/24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22222
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.0/24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1024-65536
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Aceitar
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
443
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Aceitar
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
443
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Aceitar
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rejeitar
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Resultado do processamento no 
\shape italic
firewall
\shape default

\begin_inset CommandInset label
LatexCommand label
name "tab:Resultado-do-processamento-fw"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="6">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#Pct
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IP origem
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Porta envio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IP destino
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Porta alvo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Situação
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
198.51.100.55
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
443
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ACEITO em 4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
443
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
198.51.100.55
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
45045
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ACEITO em 5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
198.51.100.55
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60365
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
21
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
REJEITADO em 6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.0.2.237
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
53385
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22222
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ACEITO em 1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203.0.113.71
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22222
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.0.2.237
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
53385
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
REJEITADO em 6
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Os pacotes aceitos são transmitidos ao próximo nó da rede: o balanceador
 de carga.
\end_layout

\begin_layout Standard
Para que o 
\shape italic
firewall
\shape default
 funcione de acordo com a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Um-dia-dentro"

\end_inset

, são necessárias duas interfaces de rede para diferenciar os fluxos do
 (e para o) mundo externo, e o fluxo do (e para o) balanceador de carga.
 Essa separação naturalmente exige dois conjuntos mínimos de elementos para
 tratar os pacotes na camada de enlace, respondendo e realizando requisições
 ARP, e classificando os pacotes conforme seus cabeçalhos.
 Exige também que o arquivo de configuração da máquina virtual a abrigar
 o 
\shape italic
firewall
\shape default
 ative as placas de rede e atribua endereços IP, endereços MAC e os 
\shape italic
switches
\shape default
 virtuais nos quais a interface se conecta.
\end_layout

\begin_layout Standard
Com relação a memória e processamento, as máquinas virtuais não exigem muitos
 recursos, a ponto de 12MB de memória e um processador virtual fazerem a
 maioria das tarefas, inclusive um 
\shape italic
firewall
\shape default
, como demonstra 
\begin_inset CommandInset citation
LatexCommand cite
key "martins_clickos_2014"

\end_inset

.
 Em caso de problemas, ClickOS dá sinais sobre sua problemas no registro
 de erros e alertas, e portanto, uma heurística pode definir melhor quais
 recursos ajustar para a função sem que haja desperdício.
 O tamanho das filas de saída de pacotes deve ser estudado.
\end_layout

\begin_layout Standard
Uma vez que os conjuntos de elementos são corretamente configurados, é preciso
 tratar os quadros.
 O uso do elemento 
\family typewriter
Strip
\family default
, passando o número de 
\shape italic
Bytes
\shape default
 usados pelo cabeçalho 
\shape italic
Ethernet
\shape default
 para que os remova é o primeiro passo.
 Verificar a validade do pacote IP extraído, para garantir que este seja
 válido, é o segundo.
 Isto é providenciado pelo elemento 
\family typewriter
CheckIPHeader
\family default
, que também pode filtrar pacotes com base em IPs indesejados, principalmente
 IPs de comunicação abrangente (
\shape italic
broadcasts
\shape default
).
 Depois desse tratamento e checagem, é possível pensar no bloqueio e autorização
 de pacotes de maneira geral.
\end_layout

\begin_layout Standard
O 
\family typewriter
IPFilter
\family default
, a partir dos cabeçalhos IP, realiza filtragens de pacotes usando valores
 de endereço IP origem e destino, portas de origem e destino, e o tipo de
 protocolo de transporte, inclusive limitando pelos tipos diferentes de
 pacotes dentro destes, além de valores padrão de campos do cabeçalho.
 As regras de autorização ou bloqueio devem ser construídas com essas bases,
 atentando-se para não limitar ou autorizar acesso em excesso.
 Para conhecimento de como as regras devem ser construídas, uma consulta
 aos elementos 
\family typewriter
IPFilter
\family default
 e 
\family typewriter
IPClassifier
\family default
 na documentação é essencial 
\begin_inset CommandInset citation
LatexCommand cite
key "kohler_click:_2018"

\end_inset

.
\end_layout

\begin_layout Standard
Dois filtros devem ser configurados.
 O primeiro trabalha no sentido de entrada do fluxo externo, aceitando apenas
 pacotes cujos cabeçalhos cumpram requisitos de endereço de rede IP de origem,
 endereço único IP de destino, número de porta de origem dentro de um intervalo,
 e por fim, o número único de porta de destino, limitando não só os recursos
 e serviços acessados na rede interna, como para quem estão disponíveis,
 e ignorando os demais; já o segundo trabalha no sentido de saída do fluxo,
 portanto, vindo do balanceador.
 Este aceita que apenas os pacotes-resposta retornem ao mundo externo de
 onde vieram suas requisições, e visa limitar a comunicação indesejada dos
 dispositivos balanceados, ignorando os demais pacotes e servindo de camada
 de proteção contra as invasões, principalmente.
 Uma análise de tráfego é mandatória para que nenhuma comunicação crítica
 dos dispositivos seja bloqueada nas redes envolvidas, no caso de 
\shape italic
firewall
\shape default
 e balanceador em sistemas já implantados.
\end_layout

\begin_layout Standard
Uma vez que os quadros fluem pelas duas interfaces de rede, eles são classificad
os, extraídos de seus cabeçalhos 
\shape italic
Ethernet
\shape default
, e na sequência checados quanto a suas validades.
 Daí então, cada fluxo entra em seu respectivo filtro e, se autorizados,
 devem se encaminhados para o reencapsulamento do cabeçalho 
\shape italic
Ethernet
\shape default
 com destino ao balanceador ou ao mundo externo, sendo dispensado na respectiva
 fila de saída e depois no respectivo elemento de saída do ClickOS correspondent
e para chegar ao seu destino.
\end_layout

\begin_layout Standard
Por fim, pacotes não classificados são descartados.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Código para o 
\shape italic
firewall
\shape default
 em Click
\begin_inset CommandInset label
LatexCommand label
name "fig:Código-fw"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/firewall_code.png
	scale 67

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Dado o projeto descrito anteriormente, a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Código-fw"

\end_inset

 demonstra a implementação realizada.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
e 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Visão-gráfica-do-fw"

\end_inset

 a visão da mesma VNF em alto nível através de um grafo.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Da linha 2 à 5 há uma definição de macros no 
\family typewriter
AddressInfo
\family default
, que nos dois primeiros parâmetros descrevem para net0 e net1 endereços
 IP próprios, endereços IP das redes e endereços MAC respectivamente.
 Estes são os endereços atribuídos as interfaces de rede ao inserí-los nos
 elementos ARP.
 O terceiro parâmetro guarda apenas o endereço IP do balanceador de carga
 para onde são enviados os pacotes autorizados.
\end_layout

\begin_layout Standard
De 7 à 11 há a definição e declaração de dois 
\family typewriter
Classifiers
\family default
, sendo um para cada rede.
 Ambos, idênticos, são definidos para filtrar pacotes de consulta do protocolo
 ARP na porta de saída 0, pacotes de respostas do protocolo ARP na porta
 de saída 1, pacotes do protocolo IP quaisquer na porta de saída 2, e por
 fim os demais pacotes na porta de saída 3.
\end_layout

\begin_layout Standard
Nas linhas 13 e 14, acontece a conexão entre 
\family typewriter
FromDevices
\family default
 das interfaces de rede e a porta de entrada 0 de seus respectivos 
\family typewriter
Classifiers
\family default
.
\end_layout

\begin_layout Standard
Nas linhas 16 e 17 há a declaração e definição das duas 
\family typewriter
Queues
\family default
 necessárias para a conversão do fluxo 
\shape italic
push
\shape default
 em 
\shape italic
pull
\shape default
 no momento do despacho dos pacotes já filtrados, sendo uma para cada interface
 novamente.
 A porta de saída 0 de cada uma se conecta com a porta de entrada 0 do respectiv
o 
\family typewriter
FromDevice
\family default
 da respectiva interface de rede.
\end_layout

\begin_layout Standard
Logo abaixo, na linha 19 e 20, duas novas declarações e definições são realizada
s, com o intuito de inserir o par de endereços IP e MAC de cada interface
 da VNF (net0 e net1) no respectivo 
\family typewriter
ARPQuerier
\family default
, para quê o elemento de consulta desse protocolo realize o correto encapsulamen
to no nível da camada de enlace, principalmente o que diz respeito ao MAC
 de origem.
 Após isso, a porta de saída 0 de tais elementos é conectada a porta de
 entrada da respectiva fila.
\end_layout

\begin_layout Standard
Continuando nas linhas 22 e 23, as portas de saída 1 dos classificadores
 contém as respostas de consultas ARP, e são conectadas as portas de entrada
 1 dos respectivos elementos de consulta para que receba as respostas corretamen
te e possa encapsular pacotes IP com o correto endereço MAC de destino consultad
o.
\end_layout

\begin_layout Standard
Nas linhas 25 e 26, as portas de saída 0 de ambos classificadores se conectam
 as respectivas portas de entradas 0 do elemento 
\family typewriter
ARPResponder
\family default
 respondendo as requisições de outros dispositivos com o correto endereço
 MAC para o endereço IP consultado.
 Tal elemento é responsável por atribuir o endereço IP daquela interface
 de rede na VNF, podendo responder por mais de um deles caso seja desejado.
 Perceba que os endereços configurados aqui são os mesmos que foram configurados
 nas linhas 19 e 20, para que haja não só o recebimento dos pacotes mas
 também a correta indicação ao par da comunicação de quem a máquina é na
 rede.
\end_layout

\begin_layout Standard
Nas linhas 28 e 29, ocorre uma declaração e definição do 
\family typewriter
IPFilter
\family default
 que está relacionado a entrada do fluxo externo.
 Ele possui apenas duas regras definidas em seus parâmetros: uma para permitir
 pacotes com endereço IP de origem local à interface de rede 0, que tenham
 como endereço IP de destino o balanceador de carga, cujo número da porta
 de origem esteja entre 32768 e 61000, e a porta de destino seja a porta
 80; e outra para ignorar todos os demais pacotes que cheguem.
\end_layout

\begin_layout Standard
Com a mesma intenção, nas linhas 31 e 32 há uma declaração e definição semelhant
e a anterior, mudando apenas o foco de seu uso: a intenção agora é filtrar
 os pacotes que chegam do balanceador e que estão de saída para redes externas.
 Para isso, os endereços e números de portas que eram de origem se tornam
 de destino e vice-versa.
\end_layout

\begin_layout Standard
Entre as linhas 34 e 37, a porta de saída 2 do classificador da rede 0 entrega
 os pacotes para o 
\family typewriter
Strip
\family default
, que por sua vez despacha os pacotes IP para o elemento de checagem do
 cabeçalho IP, que por sua vez passa os pacotes checados para o 
\family typewriter
CheckIPHeader
\family default
, que realizando sua tarefa, encaminha-os para o encapsulamento da camada
 de enlace da rede 1 no 
\family typewriter
ARPQuerier
\family default
, fluindo em direção a interface de rede, onde está o balanceador de carga.
 Todas as portas não mencionadas, sejam de entrada ou saída, são de índice
 0.
\end_layout

\begin_layout Standard
De maneira semelhante, entre as linhas 39 e 42 o processo se repete, e os
 pacotes-resposta vindos do balanceador pela interface de rede 1 que são
 autorizados, então são entregues para encapsulamento na rede 0, fluindo
 em direção a sua respectiva interface do requisitante.
\end_layout

\begin_layout Standard
Por último, nas linhas 44 e 45, os pacotes que saem pela porta 3 do classificado
r entram em um elemento que determina o descarte deles.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Balanceador-de-Carga"

\end_inset

Balanceador de Carga
\end_layout

\begin_layout Standard
A proposta para esta VNF é dividir um determinado fluxo entre servidores
 de uma função semelhante, diminuindo a possibilidade de um servidor específico
 sobrecarregar ou ter vida útil reduzida, conferindo maior disponibilidade
 e durabilidade dos equipamentos.
 Podem haver duas versões, entre o método conhecido como 
\shape italic
Round Robin
\shape default
 e o método por endereço IP de origem.
 O primeiro divide os pacotes para os servidores com base em um tempo de
 concessão fixo e o segundo envia todos os pacotes com um mesmo endereço
 IP de origem para o mesmo servidor destino, fazendo a seleção com base
 em uma função de 
\shape italic
hashing
\shape default
.
 O balanceador 
\shape italic
Round Robin
\shape default
 não avalia a carga atual e a situação atual dos servidores para tomar as
 decisões, recebendo como entrada apenas o número de servidores disponibilizados.
\end_layout

\begin_layout Standard
Dado 1500 pacotes emitidos pelo cliente, com o método 
\shape italic
Round Robin
\shape default
 espera-se, idealmente, que os servidores recebam os pacotes aproximadamente
 como demonstrado na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Exemplo-de-divisão-rr"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Divisão do fluxo de pacotes vindos do cliente com Round Robin
\begin_inset CommandInset label
LatexCommand label
name "tab:Exemplo-de-divisão-rr"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dispositivo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pacotes transmitidos
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pacotes recebidos
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cliente
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Servidor 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500/n
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Servidor 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500/n
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Servidor n
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500/n
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Já no método por endereço IP de origem, com três diferentes clientes e 1500
 pacotes cada, espera-se tal qual a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Exemplo-de-divisão-sip"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Divisão do fluxo de pacotes vindos de 3 clientes com endereço IP de origem
\begin_inset CommandInset label
LatexCommand label
name "tab:Exemplo-de-divisão-sip"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dispositivo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pacotes transmitidos
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pacotes recebidos
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cliente 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cliente 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cliente 3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cliente 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cliente 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Servidor 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Servidor 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Servidor 3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4500
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Para que o balanceador de carga funcione de acordo com a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Um-dia-dentro"

\end_inset

 e a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Exemplo-de-divisão-rr"

\end_inset

, são necessárias duas interfaces de rede para diferenciar os fluxos originados
 e destinados ao mundo externo, dos fluxos originados e destinados aos servidore
s.
 Assim como no 
\shape italic
firewall
\shape default
, esta separação exige dois conjuntos mínimos de elementos na camada de
 enlace para tratar a entrada e saída na rede, gerenciar os pacotes de controle
 do protocolo ARP e separar os pacotes de acordo com o protocolo.
 A semelhança segue com os requisitos de memória e processamento, a correta
 configuração dos elementos mínimos, dos elementos de desencapsulamento
 e por fim, de dos elementos de checagem do protocolo IP.
\end_layout

\begin_layout Standard
Um elemento sem portas de entrada ou saída deve ser configurado para cada
 método descrito.
 Aquele que cobre o método 
\shape italic
Round Robin
\shape default
 (
\family typewriter
RoundRobinIPMapper
\family default
), deve conter um parâmetro para cada servidor disponível, num formato que
 indique qual a modificação para cada um dos itens dentre endereço IP de
 origem, número de porta de origem, endereço IP de destino e número de porta
 de destino, nessa ordem, sendo que os não indicados permanecem inalterados.
 Após tais indicações, os parâmetros são finalizados com o informe de uma
 porta de saída do elemento para a regra criada a partir dessas indicações,
 e o informe de uma porta de saída para a regra de conversão do seu pacote-respo
sta, já em fluxo de retorno.
 Já que este elemento não possui portas, elas são alocadas no elemento de
 NAT no 
\family typewriter
IPRewriter
\family default
, pois a função deste é fornecer novas funcionalidades ao NAT disponível
 no Click, tal qual uma variação no momento de criação de suas regras.
\end_layout

\begin_layout Standard
Diferentemente do anterior, o elemento para o método de balanceamento por
 endereço IP de origem (
\family typewriter
SourceIPHashMapper
\family default
) precisa de mais parâmetros.
 Como trabalha com uma estrutura de tabela 
\shape italic
hash
\shape default
, é preciso indicar uma semente e um tamanho de tabela como primeiro parâmetro,
 e só após iniciar com os parâmetros de modificação de cabeçalhos.
 Estes, por sua vez, possuem apenas uma modificação inserida ao final de
 cada parâmetro: um identificador para comparações na tabela é adicionado.
 Assim como o elemento anterior, ele não possui portas, servindo como uma
 nova funcionalidade ao NAT no 
\family typewriter
IPRewriter
\family default
.
\end_layout

\begin_layout Standard
O elemento de NAT (
\family typewriter
IPRewriter
\family default
) dessa proposta é simples e passa como parâmetro o conjunto de indicações
 dos elementos acima, para que sejam usados no caso dos pacotes de entrada
 de sua respectiva porta não combinarem com as regras existentes; e também
 uma outra determinação para ignorar os pacotes que entram por uma outra
 porta caso novamente não haja combinação.
\end_layout

\begin_layout Standard
Uma vez que os quadros fluam pelas duas interfaces de rede, eles são classificad
os, extraídos de seus cabeçalhos 
\shape italic
Ethernet
\shape default
, e na sequência checados quanto a suas validades.
 Dai então o fluxo vindo do mundo externo entra no 
\family typewriter
IPRewriter
\family default
 pela porta 0 e o fluxo vindo dos servidores pela sua porta 1.
 A saída do primeiro fluxo com as modificações deve acontecer pela porta
 0, e a saída do outro fluxo pela porta 1, permitindo então que a soma de
 verificação do protocolo TCP seja redefinida separadamente em ambos, através
 de elementos instanciados.
\end_layout

\begin_layout Standard
Após esse processo, os pacotes são encaminhados para o reencapsulamento
 com destino ao servidor definido pelo NAT e ao cliente, respectivamente.
 Uma observação importante é que no último caso, o destino só é alcançável
 com mais de um salto na rede, o que significa que o reencapsulamento da
 camada de enlace deve ser atribuído ao 
\shape italic
gateway
\shape default
 da rede, no caso o próprio 
\shape italic
firewall
\shape default
, para que ele possa dar destino ao pacote.
 Um elemento deve realizar a tarefa de indicá-lo antes do encapsulamento.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Código para o balanceador de carga por endereço IP de origem no Click
\begin_inset CommandInset label
LatexCommand label
name "fig:Código-lb"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/lb_code.png
	scale 65

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset

As descrições para as ações programadas entre as linhas 2 e 27 são idênticas
 para aquelas feitas na implementação  da 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Código-fw"

\end_inset

.
 O mesmo vale para as linhas 53 e 54.
\end_layout

\begin_layout Standard
Nas linhas de 29 à 33 há uma declaração e definição do 
\family typewriter
SourceIPHashMapper
\family default
, com seu tamanho de tabela 
\shape italic
hash
\shape default
 e semente como primeiro parâmetro, e nos seguintes, as modificações necessárias
 para cada servidor, a serem mapeadas no próximo elemento como regras de
 ida e volta.
 Pode-se ver também os identificadores ao final de cada parâmetro para efeitos
 de comparação.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Código para a modificação do tipo de balanceador para Round Robin
\begin_inset CommandInset label
LatexCommand label
name "fig:Código-para-rr"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/rr_code.png
	scale 65

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
No caso do 
\family typewriter
RoundRobinIPMapper
\family default
 (ver 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Código-para-rr"

\end_inset

), as linhas do outro elemento de balanceamento descritas acima são substituídas
 pela declaração e definição do referido elemento, onde os parâmetros se
 limitam às modificações necessárias para endereçar cada servidor disponível,
 sem os identificadores naturais a tabela 
\shape italic
hash
\shape default
.
\end_layout

\begin_layout Standard
Nas linhas 34 à 36 acontece uma declaração e definição do 
\family typewriter
IPRewriter
\family default
, que conforme os parâmetros define as regras descritas pelos elementos
 de balanceamento.
 Ele reescreve apenas os pacotes que entram pela sua porta 0 seja criando
 a partir dos parâmetros ou utilizando regras definidas, uma vez que os
 pacotes que entram pela porta 1 são ignorados caso não possuam uma regra
 preexistente.
\end_layout

\begin_layout Standard
Entre as linhas 38 e 44, dado que as portas não mencionadas de entrada e
 saída são portas 0, os 
\family typewriter
Classifiers
\family default
 das diferentes interfaces de rede enviam os pacotes IP por suas portas
 de saída 2, onde entram respectivos 
\family typewriter
Strips
\family default
, indo direto para a entrada 
\family typewriter
CheckIPHeader
\family default
, e após esse processo, entram cada um em uma porta de entrada diferente
 do elemento responsável pelo NAT.
 O fluxo vindo do mundo externo entra pela porta 0 e se depara com o elemento
 de balanceamento, que nesse caso sorteia um servidor e executa a reescrita
 de cabeçalho, enviando o pacote pela sua porta de saída 0.
 O fluxo de retorno entra pela porta 1 e espera encontrar a regra inversa
 a alteração efetuada para que possa retornar para o dispositivo requisitante.
 através da porta de saída 1.
 Caso não encontrem a regra, os pacotes nessa situação são simplesmente
 ignorados como mencionado.
\end_layout

\begin_layout Standard
As saídas do NAT entre as linhas 46 e 51 têm como destino o encapsulamento
 no respectivo 
\family typewriter
ARPQuerier
\family default
.
 No caso, o encapsulamento dos pacotes que chegam de fora, é feito pelo
 elemento ARP associado a rede do balanceador, e vice versa.
 Porém antes, precisam ter suas somas de verificação do protocolo TCP refeitas
 com 
\family typewriter
SetTCPChecksum
\family default
 para evitar erros de validação dos pacotes.
 No caso do ramo contendo os pacotes-resposta, também requer um elemento
 que anota o endereço do 
\shape italic
gateway
\shape default
 ao pacote para que o encapsulamento seja feito com ele, mesmo sem alterar
 o cabeçalho IP.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Inserir clicky
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
inserir o anexo com códigos
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Chapter
TESTES 
\begin_inset CommandInset label
LatexCommand label
name "chap:TESTES"

\end_inset


\end_layout

\begin_layout Standard
Dadas as implementações de 
\shape italic
firewall
\shape default
 e balanceador de carga, os testes demonstram suas validades.
 Este capítulo discorre sobre os recursos de 
\shape italic
hardware
\shape default
 e 
\shape italic
software
\shape default
 necessários para a execução dos testes (
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Infraestrutura-e-softwares"

\end_inset

 e 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Alocação-de-recursos"

\end_inset

); encaminha a configuração de um ambiente de testes com simulação em um
 serviço de hospedagem de páginas 
\shape italic
web
\shape default
 na internet, tomando como base os elementos construídos no 
\begin_inset CommandInset ref
LatexCommand formatted
reference "chap:PROJETO-E-IMPLEMENTAÇÃO"

\end_inset

 (
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Protótipo"

\end_inset

); propõe os testes funcionais para o 
\shape italic
firewall
\shape default
 e os balanceadores de carga, descrevendo a execução e apresentando os resultado
s encontrados, pontuando seus detalhes (
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Proposta_exec_resultados"

\end_inset

).
\end_layout

\begin_layout Section
Infraestrutura e softwares
\begin_inset CommandInset label
LatexCommand label
name "sec:Infraestrutura-e-softwares"

\end_inset


\end_layout

\begin_layout Standard
A estrutura utilizada para os testes consiste em um servidor de virtualização
 com VMware, onde uma máquina virtual com o sistema operacional Debian é
 alocada para todo o experimento.
 As especificações estão na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Especificações-de-hardware"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hospedeiro - Dell PowerEdge R820
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Máquina Virtual - dom0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8 CPUs x Intel Xeon CPU E5-4603 @ 2.00GHz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4 vCPUs
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
383.96 GB de RAM DDR3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6GB de RAM
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 HDs x 2TB
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20GB de HD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
VMware ESXi 6.5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Debian Server 8.7 - kernel 3.16.51-3
\end_layout

\end_inset
</cell>
</row>
<row endfirsthead="true" caption="true">
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Especificações de hardware para os testes
\begin_inset CommandInset label
LatexCommand label
name "tab:Especificações-de-hardware"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Como dito na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:ClickOS"

\end_inset

, ClickOS introduz uma nova camada de virtualização ao sistema que o hospeda
 através do Xen, e isso ocorre dentro de outra camada de virtualização provida
 pelo VMware, o que não parece ideal.
 Como o foco deste trabalho é a implementação, o excesso de camadas de virtualiz
ação não se mostrou um problema da maior relevância.
 Reserva-se para trabalhos futuros a otimização deste ambiente de testes
 com foco em desempenho.
\end_layout

\begin_layout Standard
Ao que se refere aos softwares instalados na máquina virtual criada pelo
 VMware, uma lista não extensiva deles está na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Softwares-para-a-vm"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="3">
<features islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tipo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Software
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Versão
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Provedor de VNFs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ClickOS
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hypervisor
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Xen Project 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.4.1-9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Manipulador de VNFs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cosmos
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Switch virtual
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Linux Bridge
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.16.51-3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gerente do Switch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bridge utilities
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.5-9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Monitor de rede
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
BWM-NG
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.6-3.1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Analisador de tráfego
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tcpdump
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.9.2-1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sincronizador de relógio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ntpdate
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.2.6
\end_layout

\end_inset
</cell>
</row>
<row endfirsthead="true" caption="true">
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Softwares para a VM hospedeira
\begin_inset CommandInset label
LatexCommand label
name "tab:Softwares-para-a-vm"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Importante mencionar que a criação do ClickOSSwitch pelos autores do ClickOS
 não exclui a possibilidade de uso de outros comutadores como o próprio
 OpenVSwitch e o Linux Bridge.
 A consequência do uso destes outros é a perda de desempenho de rede de
 forma geral, mas para testes e aplicações que não exijam desempenho prontamente
, a plataforma incentiva o desenvolvimento naquilo que mais importa: as
 VNFs.
 Com a facilidade de uso, de ativação, de configuração e confiabilidade
 do Linux Bridge, criar o ambiente para desenvolvimento das funções virtuais
 e operá-lo consome bem menos tempo do que algo customizado nos demais 
\shape italic
switches
\shape default
 citados por este trabalho.
 Esse trecho é importante no contexto deste trabalho, uma vez que o foco
 é a implementação e o Linux Bridge entrega o mínimo para a troca de fluxos.
\end_layout

\begin_layout Standard
Já os 
\shape italic
softwares
\shape default
 instalados nas máquinas virtualizadas pelo Xen que fazem papel de clientes
 (
\family typewriter
cli[1-3]
\family default
) do serviço de hospedagem 
\shape italic
web
\shape default
 são descritos na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Softwares-para-as-cli"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tipo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Software
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Versão
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sistema Operacional
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Debian Server
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 8.7 - kernel 3.16.51-3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gerador de tráfego HTTP
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Siege
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.0.8-1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Navegador web
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lynx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.8.9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sincronizador de relógio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ntpdate
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.2.6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gerente de interfaces de rede
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ifconfig
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.60-26
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gerente de rotas de rede
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
route
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.60-26
\end_layout

\end_inset
</cell>
</row>
<row endfirsthead="true" caption="true">
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Softwares para as VMs clientes
\begin_inset CommandInset label
LatexCommand label
name "tab:Softwares-para-as-cli"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Por fim, os 
\shape italic
softwares
\shape default
 instalados nas máquinas virtualizadas pelo Xen que fazem o papel de servidores
 
\shape italic
web
\shape default
 (
\family typewriter
ws[1-3]
\family default
) do serviço em questão são descritas na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Softwares-para-as-srvds"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top" width="0pt">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tipo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Software
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Versão
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sistema Operacional
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Debian Server
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 8.7 - kernel 3.16.51-3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Serviço de hospedagem web
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Apache
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Worker - 2.4.10-10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gerente de interfaces de rede
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ifconfig
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.60-26
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gerente de rotas de rede
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
route
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.60-26
\end_layout

\end_inset
</cell>
</row>
<row endfirsthead="true" caption="true">
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Softwares para as VMs servidoras
\begin_inset CommandInset label
LatexCommand label
name "tab:Softwares-para-as-srvds"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Section
Alocação de recursos
\begin_inset CommandInset label
LatexCommand label
name "sec:Alocação-de-recursos"

\end_inset


\end_layout

\begin_layout Standard
Mesmo com as modificações feitas pelo ClickOS, o Xen ainda sim é capaz de
 entregar virtualização de máquinas com sistemas operacionais gerais como
 os GNU/Linux.
 Isso possibilita que o ambiente de teste seja todo desenvolvido em um mesmo
 local, facilitando o processo de implantação dos testes.
 Além das máquinas virtualizadas citadas na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Infraestrutura-e-softwares"

\end_inset

, aqui o Xen também virtualiza duas micro-VMs para o 
\shape italic
firewall
\shape default
 e o balanceador de carga respectivamente.
 Os recursos alocados para cada uma delas através de virtualização seguem
 na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Recursos-do-hospedeiro"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Recurso
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Alocado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Processador
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 CPU dedicado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Memória
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1GB dedicado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Disco
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20GB
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Swap em disco
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1280MB alocados dinamicamente
\end_layout

\end_inset
</cell>
</row>
<row endfirsthead="true" caption="true">
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Recursos do hospedeiro (dom0)
\begin_inset CommandInset label
LatexCommand label
name "tab:Recursos-do-hospedeiro"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Esta alocação dedicada retira tais recursos do total disponível para a virtualiz
ação, assim restando 5GB de memória e três processadores dos fornecidos
 pelo VMware para toda a estrutura do teste.
 Os recursos restantes são todos compartilhados com os dispositivos abaixo
 para clientes 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Recursos-das-três-cli"

\end_inset

, servidores 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Recursos-das-três-srvds"

\end_inset

, e VNFs 
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:Recursos-das-duas-vnfs"

\end_inset

:
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Recurso
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Alocado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Processador
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 CPU compartilhado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Memória
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
256MB compartilhado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Disco
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6GB alocados dinamicamente
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Swap em disco
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
512MB alocados dinamicamente
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interface de Rede
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2x em modo bridge
\end_layout

\end_inset
</cell>
</row>
<row endfirsthead="true" caption="true">
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Recursos das três VMs clientes
\begin_inset CommandInset label
LatexCommand label
name "tab:Recursos-das-três-cli"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Recurso
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Alocado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Processador
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 CPU compartilhado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Memória
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
768MB compartilhado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Disco
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6GB alocados dinamicamente
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Swap em disco
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
768MB alocados dinamicamente
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interface de Rede
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2x em modo bridge
\end_layout

\end_inset
</cell>
</row>
<row endfirsthead="true" caption="true">
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Recursos das três VMs servidoras
\begin_inset CommandInset label
LatexCommand label
name "tab:Recursos-das-três-srvds"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Recurso
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Alocado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Processador
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 CPU compartilhado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Memória
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24MB compartilhado
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interface de Rede
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2x em modo bridge
\end_layout

\end_inset
</cell>
</row>
<row endfirsthead="true" caption="true">
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Recursos das duas VMs para as VNFs
\begin_inset CommandInset label
LatexCommand label
name "tab:Recursos-das-duas-vnfs"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
inserir anexo com arquivos de configuração
\end_layout

\end_inset


\end_layout

\begin_layout Section
Protótipo
\begin_inset CommandInset label
LatexCommand label
name "sec:Protótipo"

\end_inset


\end_layout

\begin_layout Standard
Os recursos mencionados na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Alocação-de-recursos"

\end_inset

 foram alocados pensando em um ambiente de validação baseado em hospedagem
 
\shape italic
web
\shape default
.
 Nesse ambiente é provável encontrar equipamentos que desempenham as funções
 de rede implementadas no capítulo anterior, com cenários bem mais complexos
 e completos.
 No entanto, o ambiente proposto abstrai um pouco disso quando conecta o
 cliente diretamente ao 
\shape italic
firewall
\shape default
, sem saltos e sem que ao invés disso haja um dispositivo que redirecione
 as requisições ao mesmo.
 Mas é importante notar que esta adaptação não prejudica os testes que são
 propostos na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Proposta_exec_resultados"

\end_inset

.
 O protótipo planejado segue na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Protótipo-para-execução"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Protótipo para execução dos testes
\begin_inset CommandInset label
LatexCommand label
name "fig:Protótipo-para-execução"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/graphs/undergrad-thesis topology.png
	scale 58

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Quatro pontes (
\shape italic
bridges
\shape default
) 
\shape italic
Ethernet
\shape default
 foram criadas no 
\shape italic
switch
\shape default
 virtual Linux Bridge para prover as conexões entre as máquinas virtuais
 e o 
\shape italic
firewall
\shape default
, este e o balanceador, e deste último com os servidores.
 A última delas é uma ponte para que o autor pudesse gerenciar mais facilmente
 as máquinas clientes, que exigiam mais modificações que eram dificultadas
 pelo terminal pouco responsivo do Xen para o Debian.
\end_layout

\begin_layout Standard
Após criadas e configuradas com seus 
\shape italic
softwares
\shape default
, as máquinas usuárias têm suas interfaces de rede configuradas com um IP
 e máscara de sub-rede usados para a comunicação entre VMs (198.51.100.0/24)
 e outro para que o controle das operações seja realizado de outra máquina
 (192.168.0.0/23) via Secure Shell (SSH).
 Tal configuração é feita na linha de comando das VMs clientes para cada
 interface de rede usando o 
\family typewriter
ifconfig
\family default
, e também no arquivo de configuração das VMs no hospedeiro.
 Neste arquivo também se determina a qual rede do 
\shape italic
switch
\shape default
 virtual as interfaces de rede virtuais das VMs estão conectadas.
 No caso do protótipo, trata-se das redes dentro das áreas amarelas da 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Protótipo-para-execução"

\end_inset

 e a rede de controle que não é exibida na figura.
 Por fim, as interfaces usadas para o teste em si recebem através do comando
 
\family typewriter
route
\family default
 a informação de um 
\shape italic
gateway
\shape default
.
 Isto é essencial para que os pacotes cheguem até o serviço 
\shape italic
web
\shape default
, tendo o 
\shape italic
firewall
\shape default
 como intermediário.
\end_layout

\begin_layout Standard
O 
\shape italic
firewall
\shape default
 e o balanceador de carga recebem boa parte das suas configurações na fase
 de implementação, de modo estático, tais como IPs e máscaras de sub-rede
 como os vistos na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Protótipo-para-execução"

\end_inset

.
 Para uma melhor visualização da configuração de rede dessas VNFs, o ideal
 é consultar a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Firewall"

\end_inset

 e a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Balanceador-de-Carga"

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
adicionar o anexo dos .cfg
\end_layout

\end_inset

.
 No mais, os arquivos de configuração das VMs no hospedeiro recebem as informaçõ
es sobre as redes do 
\shape italic
switch
\shape default
 virtual usadas em cada uma e as mesmas configurações de endereço IP, e
 máscara do código Click.
 
\end_layout

\begin_layout Standard
Idênticos aos clientes com relação a configuração de rede, os servidores
 
\shape italic
web
\shape default
 não possuem interfaces de rede virtuais para seu gerenciamento, já que
 se configurados uma única vez se tornam dispositivos passivos nesse quesito,
 com modificações esporádicas e suportáveis através do terminal Xen para
 Debian no hospedeiro.
 Antes de inseridos a rede local alimentada pelo balanceador de carga (172.16.0.0/1
2), seus softwares são configurados e recebem a página 
\shape italic
web
\shape default
 que será usada para os testes, que possui cerca de 200 Bytes.
 Trata-se de uma página em Linguagem de Marcação de Hipertexto (HTML) minimalist
a contendo apenas a identificação exclusiva de cada um dos três servidores.
 Nenhum ajuste extra foi feito no Apache Worker.
 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
além do bloqueio de escrita de registros apenas para os testes da 
\begin_inset CommandInset ref
LatexCommand formatted
reference "subsec:Desempenho"

\end_inset

, já que as operações estavam afetando sensivelmente a análise dos resultados.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Alguns detalhes comuns a alguns ou a todos os dispositivos:
\end_layout

\begin_layout Alineas
A Unidade de Transporte Máxima (MTU) é padronizada em 1500 bytes para todos
 do protótipo através do uso do comando 
\family typewriter
ifconfig 
\family default
nas interfaces de rede virtuais e nas interfaces do 
\shape italic
switch
\shape default
 virtual;
\end_layout

\begin_layout Alineas
Os relógios dos clientes, servidores web, e hospedeiro foram sincronizados
 antes dos testes para facilitar a análise dos resultados, usando o Ntpdate
 com o servidor 
\family typewriter
b.ntp.br
\family default
 do Núcleo de Informação e Coordenação do Ponto BR (NIC.BR).
\end_layout

\begin_layout Section
Proposta, execução e resultados
\begin_inset CommandInset label
LatexCommand label
name "sec:Proposta_exec_resultados"

\end_inset


\end_layout

\begin_layout Standard
Nesta seção, dois testes principais são descritos dentro do protótipo descrito
 na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Protótipo"

\end_inset

.
 A 
\begin_inset CommandInset ref
LatexCommand formatted
reference "subsec:Firewall"

\end_inset

 testa a função do 
\shape italic
firewall
\shape default
 em bloquear o acesso a determinadas portas e endereços, como por exemplo,
 a capacidade da função de rede programada de exercer o bloqueio ao acesso
 por máquinas indesejáveis.
 Já a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "subsec:Balanceador-de-carga-sip"

\end_inset

 e a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "subsec:Balanceador-de-carga-rr"

\end_inset

 testam a função do balanceador de carga em dividir o fluxo de entrada entre
 vários servidores com base no endereço IP de origem, no primeiro caso,
 e com base no método 
\shape italic
Round Robin
\shape default
, no segundo.
\end_layout

\begin_layout Subsection
Firewall
\begin_inset CommandInset label
LatexCommand label
name "subsec:Firewall"

\end_inset


\end_layout

\begin_layout Standard
Usando o Siege 
\begin_inset CommandInset citation
LatexCommand cite
key "noauthor_siege_nodate"

\end_inset

 a partir de um cliente qualquer da rede, emite-se tráfego tendo como destino
 a borda do serviço de hospedagem como na figura 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Protótipo-para-execução"

\end_inset

.
 O tráfego HTTP gerado passa obrigatoriamente pelo 
\shape italic
firewall
\shape default
, permitindo uma análise detalhada do fluxo, realizando concessões e bloqueios
 conforme a proposta.
 
\end_layout

\begin_layout Standard
As decisões tomadas pela função afetam a execução do Siege.
 Para monitorá-las, aplica-se o BWM-NG 
\begin_inset CommandInset citation
LatexCommand cite
key "gropp_bwm-ng:_2018"

\end_inset

 nas interfaces virtuais relacionadas ao 
\shape italic
firewall
\shape default
 e ao cliente em questão, a procura de padrões que demonstrem o comportamento
 do fluxo.
 Não trafegam quaisquer outras conexões pelas interfaces testadas.
\end_layout

\begin_layout Standard
Para a execução, executa-se os softwares em paralelo e sincronizadamente,
 com o Siege no cliente e o BWM-NG no hospedeiro da plataforma ClickOS.
 O primeiro é configurado para uma execução em no máximo quinze segundos
 com cem processos concorrentes emitindo requisições para 
\family typewriter
http://192.0.2.61:X/index2.html
\family default
, onde 
\family typewriter
X
\family default
 é o número da porta a ser acessada.
 Já o segundo guarda uma leitura do fluxo dos pacotes a cada meio segundo
 nas interfaces selecionadas, de acordo com padrão de Valores Separados
 por Vírgula (CSV).
\end_layout

\begin_layout Standard
Para auxílio na geração dos gráficos e análise dos resultados, os arquivos
 resultantes de ambos comandos armazenam o tempo em segundos do relógio
 do sistema.
 Para tornar os gráficos mais limpos, foram excluídas as representações
 dos clientes não utilizados no momento da execução.
 Para a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Fluxo-de-pacotes-fw-80"

\end_inset

 e a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Fluxo-de-pacotes-fw-8080"

\end_inset

, 
\family typewriter
cli_in
\family default
, 
\family typewriter
cli_out
\family default
, 
\family typewriter
fw_in
\family default
 e 
\family typewriter
fw_out
\family default
 significam respectivamente entrada de quadros no cliente, saída de quadros
 do cliente, entrada de quadros no 
\shape italic
firewall
\shape default
 e saída de quadros do 
\shape italic
firewall
\shape default
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Fluxo de pacotes TCP 80 com foco no 
\shape italic
firewall
\shape default

\begin_inset CommandInset label
LatexCommand label
name "fig:Fluxo-de-pacotes-fw-80"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/results/tfw/p80_pctsOUTGOING.png
	lyxscale 95
	scale 54

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/results/tfw/p80_pctsINCOMING.png
	lyxscale 95
	scale 54

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Fluxo de pacotes TCP 8080 com foco no 
\shape italic
firewall
\shape default

\begin_inset CommandInset label
LatexCommand label
name "fig:Fluxo-de-pacotes-fw-8080"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/results/tfw/p8080_pctsOUTGOING.png
	lyxscale 95
	scale 54

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/results/tfw/p8080_pctsINCOMING.png
	lyxscale 95
	scale 54

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Como se pode observar na parte superior da 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Fluxo-de-pacotes-fw-80"

\end_inset

, o cliente configurado para enviar o fluxo de requisições através da porta
 TCP 80 possui um padrão condizente com o esperado em uma conexão normal,
 respeitando o controle de fluxo nativo do TCP, e sem perdas significantes.
 O tráfego gerado por ele é notado nas interfaces de entrada e de saída
 do 
\shape italic
firewall
\shape default
, demonstrando aceitação deste pelas regras.
 No outro sentido do tráfego e na parte inferior da figura, as respostas
 mantêm proporções semelhantes se comparadas ao gráfico de envio, salvo
 variações mínimas nas quantidades a serem interpretadas como naturais ao
 procedimento de medição, e demonstrando inexistência de condições adversas.
\end_layout

\begin_layout Standard
Já o cliente configurado para enviar requisições HTTP pela porta TCP 8080,
 na parte superior da 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Fluxo-de-pacotes-fw-8080"

\end_inset

, demonstra problemas para utilizar o protocolo para estabelecer transporte
 para o servidor 
\shape italic
web
\shape default
, enviando apenas cem pacotes de abertura de conexão TCP em intervalos de
 tempo binários, e que não aparecem na interface virtual de saída do 
\shape italic
firewall
\shape default
, sendo então bloqueados pela função virtual de rede.
 Este número não é em vão, já que são cem os processos concorrentes que
 requisitam conexões com o serviço.
 Se o fluxo de saída não chega ao serviço, logo é improvável que seja haja
 resposta em forma de tráfego de entrada representado na parte inferior,
 o que de fato não ocorre exceto por um único pacote, que por exclusão,
 é uma resposta ARP do próprio 
\shape italic
firewall
\shape default
 a uma requisição do cliente (veja no instante 6s de ambos gráficos).
 Importante lembrar que este 
\shape italic
firewall
\shape default
 trabalha apenas com filtragem de pacotes IP e não responde pelos pacotes
 ARP, que seguem outros fluxos na árvore de execução do Click como visto
 na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Uma-aplicação-dos"

\end_inset

.
\end_layout

\begin_layout Subsection
Balanceador de carga por endereço IP de origem
\begin_inset CommandInset label
LatexCommand label
name "subsec:Balanceador-de-carga-sip"

\end_inset


\end_layout

\begin_layout Standard
Neste teste, três clientes emitem fluxos para a borda do serviço de hospedagem
 duas vezes cada, de forma que as emissões não se sobrepõem.
 O tráfego gerado passa obrigatoriamente pelo 
\shape italic
firewall
\shape default
, e uma vez filtrado chega ao balanceador, que o distribui aos servidores
 
\shape italic
web
\shape default
 configurados na VNF.
\end_layout

\begin_layout Standard
Novamente o BWM-NG é usado para monitorar as interfaces virtuais relacionadas
 ao cliente e aos servidores, que são respectivamente origem e destino dos
 quadros, a procura de padrões que demonstrem o comportamento do fluxo.
 Não existem quaisquer outras conexões vigentes no ambiente de teste.
\end_layout

\begin_layout Standard
A execução é feita em sequência, partindo do primeiro cliente ao terceiro,
 duas vezes, com a intenção de verificar a manutenção do envio dos pacotes
 ao mesmo servidor sempre.
 São seis execuções sequenciais e alternadas de duração máxima de quinze
 segundos cada para 
\family typewriter
http://192.0.2.61:80/index2.html
\family default
, gerando o arquivo CSV, e armazenando o tempo em segundos do relógio do
 sistema para auxílio na geração dos gráficos e análise dos resultados.
 O padrão de legendas do teste na 
\begin_inset CommandInset ref
LatexCommand formatted
reference "subsec:Firewall"

\end_inset

 é mantido para os gráficos destes, onde 
\family typewriter
*in
\family default
 e 
\family typewriter
*out
\family default
 significam entrada e saída com relação aos dispositivos precedentes.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Fluxo de pacotes no balanceador de carga por endereço IP
\begin_inset CommandInset label
LatexCommand label
name "fig:Fluxo-de-pacotes-lb-sip"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/results/tnatlb_sip/p80_pctsOUTGOING.png
	lyxscale 95
	scale 54

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/results/tnatlb_sip/p80_pctsINCOMING.png
	lyxscale 95
	scale 54

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Nos gráficos da 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Fluxo-de-pacotes-lb-sip"

\end_inset

 o primeiro, acima, demonstra a saída dos quadros dos clientes e a chegada
 deles nos servidores 
\shape italic
web
\shape default
 e o segundo, abaixo, demonstra o caminho contrário, onde os quadros-resposta
 retornam do servidor para o cliente.
 Em todos as seis execuções do primeiro gráfico há um cliente enviando e
 seus quadros chegando a um único servidor, inclusive mantendo a relação
 cliente-servidor definida nas primeiras execuções.
 Cada cliente foi balanceado para um servidor diferente, embora nesse caso
 não seja um resultado ruim que dois deles fossem encaminhados para o mesmo
 servidor, já que o elemento não analisa o estado atual dos nós balanceadores.
 Claro que ao se tratar de uma conexão TCP, os quadros-resposta também precisam
 retornar corretamente para que não haja uma queda na transmissão por parte
 do cliente, o que acontece e valida o bom funcionamento da VNF.
\end_layout

\begin_layout Subsection
Balanceador de carga por Round Robin
\begin_inset CommandInset label
LatexCommand label
name "subsec:Balanceador-de-carga-rr"

\end_inset


\end_layout

\begin_layout Standard
O Siege emite o mesmo tipo de fluxo do 
\shape italic
firewall
\shape default
 partir de um cliente para a borda do serviço de hospedagem.
 O tráfego HTTP na porta 80 passa obrigatoriamente pelo 
\shape italic
firewall
\shape default
, e uma vez filtrado chega ao balanceador de carga, que o distribui aos
 servidores 
\shape italic
web
\shape default
 configurados na VNF.
\end_layout

\begin_layout Standard
O BWM-NG é usado novamente para monitorar as interfaces virtuais relacionadas
 ao cliente e aos servidores 
\shape italic
web
\shape default
, que são origem e destino dos pacotes, a procura de padrões que demonstrem
 o comportamento do fluxo.
 Não trafegam quaisquer outras conexões pelas interfaces testadas.
\end_layout

\begin_layout Standard
A execução ocorre de forma parecida com a do teste anterior, porém sem a
 necessidade de múltiplas execuções ou clientes, restringindo-se a uma execução
 em um cliente.
 Logo, para tornar os gráficos mais limpos foram excluídas as representações
 dos clientes não utilizados no momento da execução.
 Com relação a legenda da 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Fluxo-de-pacotes-lb-rr"

\end_inset

, a única novidade em relação a 
\begin_inset CommandInset ref
LatexCommand formatted
reference "subsec:Balanceador-de-carga-sip"

\end_inset

 é a soma dos quadros que entram e saem dos servidores 
\shape italic
web
\shape default
, com o nome de 
\family typewriter
soma_wsx
\family default
.
 para facilitar a demonstração entre o medido na saída do cliente e a entrada
 dos servidores 
\shape italic
web
\shape default
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Fluxo de pacotes no balanceador de carga por Round Robin
\begin_inset CommandInset label
LatexCommand label
name "fig:Fluxo-de-pacotes-lb-rr"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/results/tnatlb_rr/p80_pctsOUTGOING.png
	lyxscale 95
	scale 54

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /media/Dados/felipe/Área de trabalho/undergraduate-thesis/thesis/docs/results/tnatlb_rr/p80_pctsINCOMING.png
	lyxscale 95
	scale 54

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Fonte: Elaborada pelo autor
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Na parte superior da 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Fluxo-de-pacotes-lb-rr"

\end_inset

, está o fluxo de pacotes enviados pelo cliente.
 Observa-se uma semelhança entre as quantidades de pacotes enviados pelo
 cliente e recebidos por todos os servidores.
 Os servidores 
\shape italic
web
\shape default
 recebem individualmente cerca de um terço do total de pacotes, como é possível
 ver nas três linhas que os representam, praticamente sobrepostas, e corroborand
o com a expectativa sobre o balanceador de carga desenvolvido.
\end_layout

\begin_layout Standard
Na parte inferior da figura está o fluxo de quadros recebidos pelo cliente,
 vindo dos servidores, e em resposta as requisições HTTP.
 Este gráfico se assemelha ao anterior em suas linhas e nas quantidades
 de pacotes enviados a cada intervalo, o que é de se esperar de uma rede
 neutra, e demonstrando que o teste ocorreu em perfeitas condições a partir
 dos parâmetros usados.
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Chapter
CONCLUSÃO 
\begin_inset CommandInset label
LatexCommand label
name "chap:CONCLUSÃO"

\end_inset


\end_layout

\begin_layout Standard
Reafirmar a porra toda
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "thesis"
options "abntex2-num"

\end_inset


\end_layout

\begin_layout Standard

\end_layout

\end_body
\end_document
